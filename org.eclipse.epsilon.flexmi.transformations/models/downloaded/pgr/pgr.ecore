<?xml version="1.0" encoding="UTF-8"?>
<ecore:EPackage xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:ecore="http://www.eclipse.org/emf/2002/Ecore" name="pgr" nsURI="http:///pgr.ecore" nsPrefix="pgr">
  <eClassifiers xsi:type="ecore:EClass" name="ModelFactory">
    <eOperations name="load" eType="#//ModelFactory">
      <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
        <details key="body" value="&#x9;&#x9;ModelFactory modelFactory = null;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;org.eclipse.emf.common.util.URI uri = org.eclipse.emf.common.util.URI.createURI(&quot;platform:/resource/PGR/models/production.pgr&quot;);&#xD;&#xA;&#x9;&#x9;org.eclipse.emf.ecore.resource.ResourceSet resourceSet= new org.eclipse.emf.ecore.resource.impl.ResourceSetImpl();&#xD;&#xA;&#x9;&#x9;org.eclipse.emf.ecore.resource.Resource resource = resourceSet.createResource(uri);&#xD;&#xA;&#x9;&#x9;try {&#xD;&#xA;&#x9;&#x9;&#x9;resource.load(java.util.Collections.EMPTY_MAP);&#xD;&#xA;&#x9;&#x9;&#x9;modelFactory = (ModelFactory) resource.getContents().get(0);&#xD;&#xA;&#x9;&#x9;} catch (java.io.IOException e) {&#xD;&#xA;&#x9;&#x9;&#x9;// TO-DO Auto-generated catch block&#xD;&#xA;&#x9;&#x9;&#x9;e.printStackTrace();&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;return modelFactory;"/>
      </eAnnotations>
    </eOperations>
    <eOperations name="save">
      <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
        <details key="body" value="&#x9;&#x9;ModelFactory modelFactory = this;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;org.eclipse.emf.common.util.URI uri = org.eclipse.emf.common.util.URI.createURI(&quot;platform:/resource/PGR/models/production.pgr&quot;);&#xD;&#xA;&#x9;&#x9;org.eclipse.emf.ecore.resource.ResourceSet resourceSet= new org.eclipse.emf.ecore.resource.impl.ResourceSetImpl();&#xD;&#xA;&#x9;&#x9;org.eclipse.emf.ecore.resource.Resource resource = resourceSet.createResource(uri);&#xD;&#xA;&#x9;&#x9;resource.getContents().add(modelFactory);&#xD;&#xA;&#x9;&#x9;try {&#xD;&#xA;&#x9;&#x9;&#x9;resource.save(java.util.Collections.EMPTY_MAP);&#xD;&#xA;&#x9;&#x9;} catch (java.io.IOException e) {&#xD;&#xA;&#x9;&#x9;&#x9;// TO-DO Auto-generated catch block&#xD;&#xA;&#x9;&#x9;&#x9;e.printStackTrace();&#xD;&#xA;&#x9;&#x9;}"/>
      </eAnnotations>
    </eOperations>
    <eStructuralFeatures xsi:type="ecore:EReference" name="theDomain" lowerBound="1"
        eType="#//domain/Domain" containment="true" eOpposite="#//domain/Domain/theModelFactory"/>
    <eStructuralFeatures xsi:type="ecore:EReference" name="theUI" lowerBound="1" eType="#//ui/UI"
        containment="true" eOpposite="#//ui/UI/theModelFactory"/>
  </eClassifiers>
  <eSubpackages name="domain" nsURI="http:///pgr/domain.ecore" nsPrefix="pgr.domain">
    <eClassifiers xsi:type="ecore:EClass" name="Domain">
      <eStructuralFeatures xsi:type="ecore:EReference" name="theUI" upperBound="-1"
          eType="#//ui/UI" eOpposite="#//ui/UI/theDomain"/>
      <eStructuralFeatures xsi:type="ecore:EReference" name="theModelFactory" eType="#//ModelFactory"
          transient="true" eOpposite="#//ModelFactory/theDomain"/>
      <eStructuralFeatures xsi:type="ecore:EReference" name="listReport" upperBound="-1"
          eType="#//domain/Report" containment="true" eOpposite="#//domain/Report/ownedByDomain"/>
      <eStructuralFeatures xsi:type="ecore:EReference" name="theViewModelGenerator"
          lowerBound="1" eType="#//domain/generators/ViewModelGenerator" containment="true"
          eOpposite="#//domain/generators/ViewModelGenerator/theDomain"/>
      <eStructuralFeatures xsi:type="ecore:EReference" name="theDataformDiagramGenerator"
          lowerBound="1" eType="#//domain/generators/DataformDiagramGenerator" containment="true"
          eOpposite="#//domain/generators/DataformDiagramGenerator/theDomain"/>
      <eStructuralFeatures xsi:type="ecore:EReference" name="theDataformGenerator"
          lowerBound="1" eType="#//domain/generators/DataformGenerator" containment="true"
          eOpposite="#//domain/generators/DataformGenerator/theDomain"/>
      <eStructuralFeatures xsi:type="ecore:EReference" name="theExcelGenerator" lowerBound="1"
          eType="#//domain/generators/ExcelGenerator" containment="true" eOpposite="#//domain/generators/ExcelGenerator/theDomain"/>
      <eStructuralFeatures xsi:type="ecore:EReference" name="theExcelUpdater" lowerBound="1"
          eType="#//domain/generators/ExcelUpdater" containment="true" eOpposite="#//domain/generators/ExcelUpdater/Domain"/>
      <eStructuralFeatures xsi:type="ecore:EReference" name="theCoordinate" lowerBound="1"
          eType="#//domain/util/Coordinate" containment="true" eOpposite="#//domain/util/Coordinate/theDomain"/>
      <eStructuralFeatures xsi:type="ecore:EReference" name="theMergedRegion" lowerBound="1"
          eType="#//domain/util/MergedRegion" containment="true" eOpposite="#//domain/util/MergedRegion/theDomain"/>
      <eStructuralFeatures xsi:type="ecore:EReference" name="theComparatorRange" lowerBound="1"
          eType="#//domain/util/ComparatorRange" containment="true" eOpposite="#//domain/util/ComparatorRange/theDomain"/>
      <eStructuralFeatures xsi:type="ecore:EReference" name="theUnzip" lowerBound="1"
          eType="#//domain/util/Unzip" containment="true" eOpposite="#//domain/util/Unzip/theDomain"/>
    </eClassifiers>
    <eClassifiers xsi:type="ecore:EClass" name="Report">
      <eStructuralFeatures xsi:type="ecore:EAttribute" name="filePath" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
      <eStructuralFeatures xsi:type="ecore:EAttribute" name="fileName" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
      <eStructuralFeatures xsi:type="ecore:EReference" name="ownedByDomain" eType="#//domain/Domain"
          transient="true" eOpposite="#//domain/Domain/listReport"/>
    </eClassifiers>
    <eSubpackages name="generators" nsURI="http:///pgr/domain/generators.ecore" nsPrefix="pgr.domain.generators">
      <eClassifiers xsi:type="ecore:EClass" name="ViewModelGenerator">
        <eOperations name="ViewModelGenerator">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="this.modelFactoryQM = modelFactoryQM;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;getProjectionQM();&#xD;&#xA;&#x9;&#x9;viewModel = gestionmodelosconsultas.modeloconsultas.model.ModelFactory.eINSTANCE.createViewModel();"/>
          </eAnnotations>
          <eParameters name="modelFactoryQM" eType="#//datatypes/datatypesqm/ModelFactory"/>
        </eOperations>
        <eOperations name="generateViewModel">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="createViewModel();"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="exploreRelations">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="for(int i=0;i&lt;projection.getListRelacion().size();i++){&#xD;&#xA;&#x9;&#x9;&#x9;gestionmodelosconsultas.modeloconsultas.model.Relacion relacion = projection.getListRelacion().get(i);&#xD;&#xA;&#x9;&#x9;&#x9;if(relacion.getSource().equals(parent)){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;ElementoConsulta queryElement = createElement((ElementoConsulta) relacion.getTarget());&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;queryElement.setOrder(order);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;viewModel.getListElementoConsulta().add(queryElement);&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;gestionmodelosconsultas.modeloconsultas.model.Relacion relation = &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;gestionmodelosconsultas.modeloconsultas.model.ModelFactory.eINSTANCE.createRelacion();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;relation.setSource(parent);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;relation.setTarget(queryElement);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;viewModel.getListRelacion().add(relation);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;exploreRelations(relacion.getTarget(), queryElement, order+1);&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;}"/>
          </eAnnotations>
          <eParameters name="parent" eType="#//datatypes/datatypesqm/ElementoConsulta"/>
          <eParameters name="parentViewModel" eType="#//datatypes/datatypesqm/ElementoConsulta"/>
          <eParameters name="order" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EIntegerObject"/>
        </eOperations>
        <eOperations name="createViewModel">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="EList&lt;gestionmodelosconsultas.modeloconsultas.ModeloConsulta> listQueryModel = &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;modelFactoryQM.getFactoryModeloConsultas().getListModeloConsulta();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;gestionmodelosconsultas.modeloconsultas.ModeloConsulta queryModel = listQueryModel.get(0);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;EList&lt;gestionmodelosconsultas.modeloconsultas.model.EADiagram> listViewModel = queryModel.getListEADiagram();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;EList&lt;gestionmodelosconsultas.modeloconsultas.model.EADiagram> newList = queryModel.createtListEADiagram();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;for(int i=0;i&lt;listViewModel.size();i++){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if(!(listViewModel.get(i) instanceof gestionmodelosconsultas.modeloconsultas.model.ViewModel))&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;newList.add(listViewModel.get(i));&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;queryModel.setEADiagram(newList);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;listViewModel = newList;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;ElementoConsulta root = getParent();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;ElementoConsulta queryElement = createElement((ElementoConsulta) root);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;queryElement.setOrder(1);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;viewModel.getListElementoConsulta().add(queryElement);&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;exploreRelations(root, queryElement, 2);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;listViewModel.add(viewModel);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;modelFactoryQM.salvar();"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="createElement" eType="#//datatypes/datatypesqm/ElementoConsulta">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#x9;&#x9;if(e instanceof gestionmodelosconsultas.modeloconsultas.quien.impl.UnidadOrganizacionalImpl)&#xD;&#xA;&#x9;&#x9;&#x9;return  gestionmodelosconsultas.modeloconsultas.quien.QuienFactory.eINSTANCE.createUnidadOrganizacional();&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;&#x9;if(e instanceof gestionmodelosconsultas.modeloconsultas.quien.impl.ActorImpl)&#xD;&#xA;&#x9;&#x9;&#x9;return gestionmodelosconsultas.modeloconsultas.quien.QuienFactory.eINSTANCE.createActor();&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;&#x9;if(e instanceof gestionmodelosconsultas.modeloconsultas.quien.impl.RolImpl)&#xD;&#xA;&#x9;&#x9;&#x9;return gestionmodelosconsultas.modeloconsultas.quien.QuienFactory.eINSTANCE.createRol();&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;&#x9;if(e instanceof gestionmodelosconsultas.modeloconsultas.quien.impl.ContactoImpl)&#xD;&#xA;&#x9;&#x9;&#x9;return gestionmodelosconsultas.modeloconsultas.quien.QuienFactory.eINSTANCE.createContacto();&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;if(e instanceof gestionmodelosconsultas.modeloconsultas.quien.impl.QuienImpl)&#xD;&#xA;&#x9;&#x9;&#x9;return gestionmodelosconsultas.modeloconsultas.quien.QuienFactory.eINSTANCE.createQuien();&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;if(e instanceof gestionmodelosconsultas.modeloconsultas.que.impl.DocumentoImpl)&#xD;&#xA;&#x9;&#x9;&#x9;return gestionmodelosconsultas.modeloconsultas.que.QueFactory.eINSTANCE.createDocumento();&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;if(e instanceof gestionmodelosconsultas.modeloconsultas.que.impl.ComunicacionImpl)&#xD;&#xA;&#x9;&#x9;&#x9;return gestionmodelosconsultas.modeloconsultas.que.QueFactory.eINSTANCE.createComunicacion();&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;&#x9;if(e instanceof gestionmodelosconsultas.modeloconsultas.como.impl.ActividadProcesoImpl)&#xD;&#xA;&#x9;&#x9;&#x9;return gestionmodelosconsultas.modeloconsultas.como.ComoFactory.eINSTANCE.createActividadProceso();&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;if(e instanceof gestionmodelosconsultas.modeloconsultas.como.impl.InstanciaProcesoImpl)&#xD;&#xA;&#x9;&#x9;&#x9;return gestionmodelosconsultas.modeloconsultas.como.ComoFactory.eINSTANCE.createInstanciaProceso();&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;if(e instanceof gestionmodelosconsultas.modeloconsultas.donde.impl.DepositoImpl)&#xD;&#xA;&#x9;&#x9;return  gestionmodelosconsultas.modeloconsultas.donde.DondeFactory.eINSTANCE.createDeposito();&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;if(e instanceof gestionmodelosconsultas.modeloconsultas.donde.impl.DiscoImpl)&#xD;&#xA;&#x9;&#x9;&#x9;return  gestionmodelosconsultas.modeloconsultas.donde.DondeFactory.eINSTANCE.createDisco();&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;if(e instanceof gestionmodelosconsultas.modeloconsultas.donde.impl.ArmarioImpl)&#xD;&#xA;&#x9;&#x9;&#x9;return gestionmodelosconsultas.modeloconsultas.donde.DondeFactory.eINSTANCE.createArmario();&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;if(e instanceof gestionmodelosconsultas.modeloconsultas.cuando.impl.FechaImpl)&#xD;&#xA;&#x9;&#x9;&#x9;return gestionmodelosconsultas.modeloconsultas.cuando.CuandoFactory.eINSTANCE.createFecha();&#xD;&#xA;&#x9;&#x9;return null;"/>
          </eAnnotations>
          <eParameters name="e" eType="#//datatypes/datatypesqm/ElementoConsulta"/>
        </eOperations>
        <eOperations name="getProjectionQM">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="for(int i=0; i&lt;modelFactoryQM.getFactoryModeloConsultas().getListModeloConsulta().get(0).getListEADiagram().size();i++){&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;if(modelFactoryQM.getFactoryModeloConsultas().getListModeloConsulta().get(0).getListEADiagram().get(i) &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;instanceof gestionmodelosconsultas.modeloconsultas.model.Proyeccion){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;projection = (gestionmodelosconsultas.modeloconsultas.model.Proyeccion)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;modelFactoryQM.getFactoryModeloConsultas().getListModeloConsulta().get(0).getListEADiagram().get(i);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;break;&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;}"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="getParent" eType="#//datatypes/datatypesqm/ElementoConsulta">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="if(projection.getListRelacion().size() == 0 &amp;&amp;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;projection.getListElementoConsulta().size() == 1) {&#xD;&#xA;&#x9;&#x9;&#x9;return projection.getListElementoConsulta().get(0);&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;ElementoConsulta firstElement=null;&#xD;&#xA;&#x9;&#x9;for (int i = 0; i &lt; projection.getListElementoConsulta().size(); i++) {&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;boolean source=false, target=false;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;for(int j=0;j&lt;projection.getListRelacion().size();j++){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;gestionmodelosconsultas.modeloconsultas.model.Relacion relacion = projection.getListRelacion().get(j); &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if(relacion.getSource().equals(projection.getListElementoConsulta().get(i)))&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;source=true;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if(relacion.getTarget().equals( projection.getListElementoConsulta().get(i)    ))&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;target=true;&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;if(source &amp;&amp; !target){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;firstElement = projection.getListElementoConsulta().get(i);&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;return firstElement;"/>
          </eAnnotations>
        </eOperations>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="modelFactoryQM" eType="#//datatypes/datatypesqm/ModelFactory"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="projection" eType="#//datatypes/datatypesqm/Proyeccion"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="viewModel" eType="#//datatypes/datatypesqm/EADiagram"/>
        <eStructuralFeatures xsi:type="ecore:EReference" name="theDomain" eType="#//domain/Domain"
            transient="true" eOpposite="#//domain/Domain/theViewModelGenerator"/>
      </eClassifiers>
      <eClassifiers xsi:type="ecore:EClass" name="DataformDiagramGenerator">
        <eOperations name="DataformDiagramGenerator">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;        this.modelFactory = modelFactory;&#xD;&#xA;        this.dataformDiagram = this.modelFactory.getListProyecto().get(0).getListDataFormDiagram().get(0);&#xD;&#xA;        this.interface1 = dataformDiagram.getTheInterface();&#xD;&#xA;    "/>
          </eAnnotations>
          <eParameters name="modelFactory" eType="#//datatypes/datatypesdataform/ModelFactory"/>
        </eOperations>
        <eOperations name="salvarDiagram">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;        org.eclipse.emf.common.util.URI uri = org.eclipse.emf.common.util.URI.createURI(&quot;platform:/resource/PGR/domain/model.tooldataform_diagram&quot;);&#xD;&#xA;        org.eclipse.emf.ecore.resource.ResourceSet resourceSet = new org.eclipse.emf.ecore.resource.impl.ResourceSetImpl();&#xD;&#xA;        org.eclipse.emf.ecore.resource.Resource resource = resourceSet.createResource(uri);&#xD;&#xA;        resource.getContents().add(diagram);&#xD;&#xA;        try {&#xD;&#xA;            resource.save(java.util.Collections.EMPTY_MAP);&#xD;&#xA;        } catch (java.io.IOException e) {&#xD;&#xA;            e.printStackTrace();&#xD;&#xA;        }&#xD;&#xA;    "/>
          </eAnnotations>
          <eParameters name="diagram" eType="#//datatypes/datatypesgmf/Diagram"/>
        </eOperations>
        <eOperations name="cargarDiagram">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;        &#xD;&#xA;        org.eclipse.emf.common.util.URI uri = org.eclipse.emf.common.util.URI.createURI(&quot;platform:/resource/PGR/domain/model.tooldataform&quot;);&#xD;&#xA;        org.eclipse.emf.ecore.resource.ResourceSet resourceSet= new org.eclipse.emf.ecore.resource.impl.ResourceSetImpl();&#xD;&#xA;        org.eclipse.emf.ecore.resource.Resource resource = resourceSet.createResource(uri);&#xD;&#xA;        try {&#xD;&#xA;            resource.load(java.util.Collections.EMPTY_MAP);&#xD;&#xA;            modelFactory =  (ModelFactory) resource.getContents().get(0);&#xD;&#xA;        } catch (java.io.IOException e) {&#xD;&#xA;            // TO-DO Auto-generated catch block&#xD;&#xA;            e.printStackTrace();&#xD;&#xA;        }&#xD;&#xA;    "/>
          </eAnnotations>
        </eOperations>
        <eOperations name="resetDiagram">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;    &#x9;&#xD;&#xA;    &#x9;try{&#xD;&#xA;&#x9;    &#x9;org.eclipse.ui.IWorkbench workbench = org.eclipse.ui.PlatformUI.getWorkbench();&#xD;&#xA;&#x9;    &#x9;org.eclipse.ui.IWorkbenchPage activePage = workbench.getActiveWorkbenchWindow().getActivePage();&#xD;&#xA;&#x9;        activePage.closeEditors(activePage.getEditorReferences(), true);&#xD;&#xA;&#x9;        org.apache.commons.io.FileUtils.touch(new java.io.File(path));&#xD;&#xA;&#x9;        java.io.File fileToDelete = org.apache.commons.io.FileUtils.getFile(path);&#xD;&#xA;&#x9;        org.apache.commons.io.FileUtils.deleteQuietly(fileToDelete);&#xD;&#xA;    &#x9;} &#xD;&#xA;    &#x9;catch(java.io.IOException e){&#xD;&#xA;    &#x9;&#x9; e.printStackTrace();&#xD;&#xA;    &#x9;}&#xD;&#xA;    "/>
          </eAnnotations>
          <eParameters name="path" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        </eOperations>
        <eOperations name="generateDiagram">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;        &#xD;&#xA;        Diagram diag = createDiagram();&#xD;&#xA;        salvarDiagram(diag);&#xD;&#xA;        openDiagram(diag);&#xD;&#xA;    "/>
          </eAnnotations>
        </eOperations>
        <eOperations name="createDiagram" eType="#//datatypes/datatypesgmf/Diagram">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;        &#xD;&#xA;        //create the diagram&#xD;&#xA;        int diagramVID = tooldataform.diagram.part.MetamodelodataformVisualIDRegistry.getDiagramVisualID(dataformDiagram);&#xD;&#xA;        if (diagramVID != tooldataform.diagram.edit.parts.DataForm_DiagramEditPart.VISUAL_ID) {&#xD;&#xA;            // error&#xD;&#xA;        }&#xD;&#xA;        Diagram diagram = org.eclipse.gmf.runtime.diagram.core.services.ViewService.createDiagram(dataformDiagram,tooldataform.diagram.edit.parts.DataForm_DiagramEditPart.MODEL_ID,tooldataform.diagram.part.MetamodelodataformDiagramEditorPlugin.DIAGRAM_PREFERENCES_HINT);&#xD;&#xA;&#xD;&#xA;        // save the ressource&#xD;&#xA;        try {&#xD;&#xA;            dataformDiagram.eResource().save(tooldataform.diagram.part.MetamodelodataformDiagramEditorUtil.getSaveOptions());&#xD;&#xA;        } catch (java.io.IOException e) {&#xD;&#xA;        &#x9;tooldataform.diagram.part.MetamodelodataformDiagramEditorPlugin.getInstance().logError(&#xD;&#xA;                    &quot;Save operation failed for: &quot; + dataformDiagram.eResource(), e); //$NON-NLS-1$&#xD;&#xA;        }&#xD;&#xA;        &#xD;&#xA;        &#x9;&#x9;&#xD;&#xA;        Node node = org.eclipse.gmf.runtime.diagram.core.services.ViewService.getInstance().createNode(new  org.eclipse.gmf.runtime.emf.core.util.EObjectAdapter(interface1), diagram, null, 0, true,tooldataform.diagram.part.MetamodelodataformDiagramEditorPlugin.DIAGRAM_PREFERENCES_HINT);&#xD;&#xA;        &#xD;&#xA;        Bounds bounds = createBounds(interface1.getPositionX(),interface1.getPositionY(),&#xD;&#xA;                interface1.getWidth(),interface1.getHeight());&#xD;&#xA;        node.setLayoutConstraint(bounds);&#xD;&#xA;        &#xD;&#xA;        initComponents(interface1, node);&#xD;&#xA;        diagram.setName(&quot;model.tooldataform_diagram&quot;);&#xD;&#xA;        &#xD;&#xA;        return diagram;&#xD;&#xA;    "/>
          </eAnnotations>
        </eOperations>
        <eOperations name="initComponents">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;        &#xD;&#xA;        for (int i=0; i &lt; graphicalContainer.getListGraphicalContainer().size(); i++) {&#xD;&#xA;        &#x9;&#xD;&#xA;        &#x9;GraphicalContainer gc = graphicalContainer.getListGraphicalContainer().get(i);&#xD;&#xA;        &#x9;        &#xD;&#xA;            Node node = org.eclipse.gmf.runtime.diagram.core.services.ViewService.getInstance().createNode(new org.eclipse.gmf.runtime.emf.core.util.EObjectAdapter(gc), (Node) parent.getPersistedChildren().get(1), null, i,true ,tooldataform.diagram.part.MetamodelodataformDiagramEditorPlugin.DIAGRAM_PREFERENCES_HINT);&#xD;&#xA;            Bounds bounds = createBounds(gc.getPositionX(),gc.getPositionY(), gc.getWidth(),gc.getHeight());&#xD;&#xA;            node.setLayoutConstraint(bounds);&#xD;&#xA;        &#x9;&#xD;&#xA;        &#x9;initComponents(graphicalContainer.getListGraphicalContainer().get(i), node);&#xD;&#xA;        }&#xD;&#xA;        &#xD;&#xA;        int size = graphicalContainer.getListGraphicalContainer().size();&#xD;&#xA;       &#xD;&#xA;        for (int j = 0; j &lt; graphicalContainer.getListIndividualElementDataForm().size(); j++) {&#xD;&#xA;        &#x9;tooldataform.formmodel.concreta.GraphicalIndividualEement ie = graphicalContainer.getListIndividualElementDataForm().get(j);          &#xD;&#xA;            Node node = org.eclipse.gmf.runtime.diagram.core.services.ViewService.getInstance().createNode(new org.eclipse.gmf.runtime.emf.core.util.EObjectAdapter(ie), (Node)parent.getPersistedChildren().get(1), null, size+j,true ,tooldataform.diagram.part.MetamodelodataformDiagramEditorPlugin.DIAGRAM_PREFERENCES_HINT);&#xD;&#xA;            Bounds bounds = createBounds(ie.getPositionX(),ie.getPositionY(), ie.getWidth(),ie.getHeight());&#xD;&#xA;            node.setLayoutConstraint(bounds);&#xD;&#xA;        }&#xD;&#xA;    "/>
          </eAnnotations>
          <eParameters name="graphicalContainer" eType="#//datatypes/datatypesdataform/GraphicalContainer"/>
          <eParameters name="parent" eType="#//datatypes/datatypesgmf/Node"/>
        </eOperations>
        <eOperations name="createBounds" eType="#//datatypes/datatypesgmf/Bounds">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;        &#xD;&#xA;        Bounds bounds =  org.eclipse.gmf.runtime.notation.NotationFactory.eINSTANCE.createBounds();&#xD;&#xA;        bounds.setX(x);&#xD;&#xA;        bounds.setY(y);&#xD;&#xA;        bounds.setWidth(width);&#xD;&#xA;        bounds.setHeight(height);&#xD;&#xA;        return bounds;&#xD;&#xA;    "/>
          </eAnnotations>
          <eParameters name="x" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="y" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="width" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="height" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="openDiagram">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;        &#xD;&#xA;        //open the diagram&#xD;&#xA;        try {    &#xD;&#xA;            //open it&#xD;&#xA;            org.eclipse.emf.common.util.URI uri = org.eclipse.emf.ecore.util.EcoreUtil.getURI(diag);&#xD;&#xA;            org.eclipse.ui.IWorkbenchPage page = org.eclipse.ui.PlatformUI.getWorkbench()    .getActiveWorkbenchWindow().getActivePage();&#xD;&#xA;            page.openEditor(new org.eclipse.emf.common.ui.URIEditorInput(uri,dataformDiagram.getName()),  tooldataform.diagram.part.MetamodelodataformDiagramEditor.ID);&#xD;&#xA;            &#xD;&#xA;        } catch (org.eclipse.ui.PartInitException e) {&#xD;&#xA;        &#x9;tooldataform.diagram.part.MetamodelodataformDiagramEditorPlugin.getInstance().logError(&#xD;&#xA;                    &quot;Unable to open editor&quot;, e); //$NON-NLS-1$&#xD;&#xA;        }&#xD;&#xA;    "/>
          </eAnnotations>
          <eParameters name="diag" eType="#//datatypes/datatypesgmf/Diagram"/>
        </eOperations>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="modelFactory" eType="#//datatypes/datatypesdataform/ModelFactory"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="dataformDiagram" eType="#//datatypes/datatypesdataform/DataForm_Diagram"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="interface1" eType="#//datatypes/datatypesdataform/Interface"/>
        <eStructuralFeatures xsi:type="ecore:EReference" name="theDomain" eType="#//domain/Domain"
            transient="true" eOpposite="#//domain/Domain/theDataformDiagramGenerator"/>
      </eClassifiers>
      <eClassifiers xsi:type="ecore:EClass" name="DataformGenerator">
        <eOperations name="DataformGenerator">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#x9; this.path = &quot;OpenXML/&quot;+ruta+&quot;/xl/&quot;;&#xD;&#xA;&#x9; this.absolutePath = as;&#xD;&#xA;&#x9; &#xD;&#xA;&#x9; reportName  = ruta;&#xD;&#xA;&#x9; &#xD;&#xA;&#x9; /*Inicializacion de las listas para evitar &#xD;&#xA;&#x9;  *NullPointer Exception&#xD;&#xA;&#x9;  */&#xD;&#xA;&#x9; listTables = new ArrayList&lt;String>();&#xD;&#xA;&#x9; listComboBox = new ArrayList&lt;String>();&#xD;&#xA;&#x9; listComboCordinate = new ArrayList&lt;pgr.domain.util.impl.CoordinateImpl>();&#xD;&#xA;&#x9; containers = new ArrayList&lt;GraphicalContainer>();&#xD;&#xA;&#x9; coordenadasInicioContenedores = new ArrayList&lt;pgr.domain.util.impl.CoordinateImpl>();&#xD;&#xA;&#x9; coordenadasFinContenedores  = new ArrayList&lt;pgr.domain.util.impl.CoordinateImpl>();&#xD;&#xA;&#x9; &#xD;&#xA;&#x9; comboNamesSorted = new ArrayList&lt;String>();&#xD;&#xA;&#x9; for (int i = 0; i &lt; 100; i++) {&#xD;&#xA;&#x9;&#x9; comboNamesSorted.add(&quot;&quot;);&#xD;&#xA;&#x9; }&#xD;&#xA;&#x9; coordenadasComboBox = new ArrayList&lt;pgr.domain.util.impl.CoordinateImpl>();&#xD;&#xA;&#x9; for (int i = 0; i &lt; 100; i++) {&#xD;&#xA;&#x9;&#x9; pgr.domain.util.impl.CoordinateImpl c = (pgr.domain.util.impl.CoordinateImpl)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9; pgr.domain.util.UtilFactory.eINSTANCE.createCoordinate();&#xD;&#xA;&#x9;&#x9; c.setX(0); c.setY(0);&#xD;&#xA;&#x9;&#x9; coordenadasComboBox.add(c);&#xD;&#xA;&#x9; }"/>
          </eAnnotations>
          <eParameters name="ruta" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
          <eParameters name="as" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        </eOperations>
        <eOperations name="generate">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#x9;&#x9;&#x9;//Incializa la model factory y el diagrama para agregar elementos en el&#xD;&#xA;&#x9;&#x9;&#x9;init();&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;//Se carga el excel a analizar&#xD;&#xA;&#x9;&#x9;&#x9;java.io.InputStream is;&#xD;&#xA;&#x9;&#x9;&#x9;try {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;is = new java.io.FileInputStream(absolutePath);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;workbook = new XSSFWorkbook(is);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;sheet = workbook.getSheetAt(0);&#xD;&#xA;&#x9;&#x9;&#x9;    &#xD;&#xA;&#x9;&#x9;&#x9;    getOrderViewModel();&#xD;&#xA;&#x9;&#x9;&#x9;    &#xD;&#xA;&#x9;&#x9;&#x9;    amountContainers++;&#xD;&#xA;&#x9;&#x9;&#x9;    &#xD;&#xA;&#x9;&#x9;&#x9;    //Se realiza identifican y se agregan las mergedRegions&#xD;&#xA;&#x9;&#x9;&#x9;    identifyMergedRegions();&#xD;&#xA;&#x9;&#x9;&#x9;      &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;//Identifica las tablas en el XML y obtiene sus dimenciones&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;getTables();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;//En el libro de visitados, marca dichas tablas para que no sean analizadas &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;//en el metodo de getExtraInformation&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;marcarTablas(listTables);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;//Se encarga de indetificar los componentes restantes que estan en el excel&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;//Ya sea contenedores, labels, combobox etc&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;getExtraInformation();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;searchBegin();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;//Se salva la produccion  del dataform&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;salvarDF();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;} catch (java.io.FileNotFoundException e) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;// TODO Auto-generated catch block&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;e.printStackTrace();&#xD;&#xA;&#x9;&#x9;&#x9;} catch (java.lang.IndexOutOfBoundsException e) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;// TODO Auto-generated catch block&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, &quot;El excel debe estar etiquetado para poder capturar el modelo mental.&quot;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  , null, javax.swing.JOptionPane.ERROR_MESSAGE);&#xD;&#xA;&#x9;&#x9;&#x9;} catch (java.io.IOException e) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;// TODO Auto-generated catch block&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, &quot;Debe seleccionar primero el archivo al &quot;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  + &quot;cual se le capturara el modelo mental.&quot;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;, null, javax.swing.JOptionPane.ERROR_MESSAGE);&#xD;&#xA;&#x9;&#x9;&#x9;}"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="searchBegin">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;org.apache.poi.xssf.usermodel.XSSFRow r;&#xD;&#xA;&#x9;&#x9;XSSFCell c;&#xD;&#xA;&#x9;&#x9;for(int i = 0; i &lt; visitedCells.size(); i++) {&#xD;&#xA;&#x9;&#x9;&#x9;r = sheet.getRow(i);&#xD;&#xA;&#x9;&#x9;&#x9;if (r != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;ArrayList&lt;Integer> aux = (ArrayList&lt;Integer>)visitedCells.get(0);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;for(int j = 0; j &lt; aux.size(); j++) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;c = r.getCell(j);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if(c != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;c.setCellType(XSSFCell.CELL_TYPE_STRING);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if(c.getStringCellValue().equals(&quot;&lt;start>&quot;)) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dataStartRow = i;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dataStartCell = j;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="setBoundsGraphicalContainer">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;graphicalContainer.setWidth(new Integer(width));&#xD;&#xA;&#x9;&#x9;graphicalContainer.setHeight(new Integer(height));&#xD;&#xA;&#x9;&#x9;graphicalContainer.setPositionX(x);&#xD;&#xA;&#x9;&#x9;graphicalContainer.setPositionY(y);&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="graphicalContainer" eType="#//datatypes/datatypesdataform/GraphicalContainer"/>
          <eParameters name="x" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="y" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="width" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="height" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="setAtributesContaimentRelation">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;c.setAMultiplicidad(tooldataform.pmoo.Cardinalidad.N);&#xD;&#xA;&#x9;&#x9;c.setBMultiplicidad(tooldataform.pmoo.Cardinalidad.N);&#xD;&#xA;&#x9;&#x9;c.setANavegable(tooldataform.pmoo.Valores.SI);&#xD;&#xA;&#x9;&#x9;c.setBNavegable(tooldataform.pmoo.Valores.SI);&#xD;&#xA;&#x9;&#x9;c.setBinding(tooldataform.pmoo.Valores.SI);&#xD;&#xA;&#x9;&#x9;c.setARol(&quot;ownedByTable&quot;+name);&#xD;&#xA;&#x9;&#x9;c.setBRol(&quot;listTable&quot;+name);&#xD;&#xA;&#x9;&#x9;c.setName(&quot;name&quot;+name);&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="c" eType="#//datatypes/datatypesdataform/Containment"/>
          <eParameters name="name" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        </eOperations>
        <eOperations name="init">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#x9;adjacenciesX = new ArrayList&lt;Integer>();&#xD;&#xA;&#x9;adjacenciesX.add(new Integer(1));&#xD;&#xA;&#x9;adjacenciesX.add(new Integer(-1));&#xD;&#xA;&#x9;adjacenciesX.add(new Integer(0));&#xD;&#xA;&#x9;adjacenciesX.add(new Integer(0));&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;adjacenciesY = new ArrayList&lt;Integer>();&#xD;&#xA;&#x9;adjacenciesY.add(new Integer(0));&#xD;&#xA;&#x9;adjacenciesY.add(new Integer(0));&#xD;&#xA;&#x9;adjacenciesY.add(new Integer(1));&#xD;&#xA;&#x9;adjacenciesY.add(new Integer(-1));&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;/*Obtiene la dimenscion del excel&#xD;&#xA;&#x9; *formato de la dimension&#xD;&#xA;&#x9; *ejemplo: A3:D7&#xD;&#xA;&#x9; */&#xD;&#xA;&#x9;dimens = getDimention();&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;String inicio = dimens.split(&quot;:&quot;)[0];&#xD;&#xA;&#x9;String fin = &#x9;dimens.split(&quot;:&quot;)[1];&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;//Se obtienen las dimensiones de la matriz de visitados&#xD;&#xA;&#x9;int w = toInt(stractColumn(fin)); &#xD;&#xA;&#x9;int h = ( Integer.parseInt(capturarNumeros(fin)));&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;visitedCells = new ArrayList&lt;ArrayList&lt;Integer>>();&#xD;&#xA;&#x9;for (int i = 0; i &lt; h + 1; i++) {&#xD;&#xA;&#x9;&#x9;ArrayList&lt;Integer> aux = new ArrayList&lt;Integer>();&#xD;&#xA;&#x9;&#x9;for (int j = 0; j &lt; w + 1; j++) {&#xD;&#xA;&#x9;&#x9;&#x9;aux.add(new Integer(0));&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;visitedCells.add(aux);&#xD;&#xA;&#x9;}&#xD;&#xA;&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;amountContainers = 0;&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;//Se obtienen las coordenandas relativas&#xD;&#xA;&#x9;pgr.domain.util.impl.CoordinateImpl coordinate = (pgr.domain.util.impl.CoordinateImpl) getCoordinates(inicio);&#xD;&#xA;&#x9;relativeX = coordinate.getX();   relativeY = coordinate.getY();&#xD;&#xA;&#xD;&#xA;&#x9;//Se instancian los objetos necesarios para crear la produccion&#xD;&#xA;&#x9;modelFactory    = tooldataform.TooldataformFactory.eINSTANCE.createModelFactory();&#xD;&#xA;&#x9;project         = tooldataform.core.CoreFactory.eINSTANCE.createProject();&#xD;&#xA;&#x9;dataformDiagram = tooldataform.formmodel.concreta.ConcretaFactory.eINSTANCE.createDataForm_Diagram();&#xD;&#xA;&#x9;domainDiagram   = tooldataform.core.CoreFactory.eINSTANCE.createDomain_Diagram();&#xD;&#xA;&#x9;interface1      = tooldataform.formmodel.concreta.ConcretaFactory.eINSTANCE.createInterface();&#xD;&#xA;&#x9;container       = tooldataform.formmodel.concreta.ConcretaFactory.eINSTANCE.createContainer();&#xD;&#xA;&#x9;container.setName(reportName);&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;//Se dan las dimensiones y ubicacion de la interfaz&#xD;&#xA;&#x9;setBoundsGraphicalContainer(interface1, 10, 10 , 850, 850);&#x9;&#xD;&#xA;&#x9;setBoundsGraphicalContainer(container, 15, 15, 800, 700);&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;/*Se relacionan adecuadamente los objetos incializados anteriormente&#xD;&#xA;&#x9; *Para generar un dataform sin errores&#xD;&#xA;&#x9; */&#xD;&#xA;&#x9;dataformDiagram.setTheInterface(interface1);&#xD;&#xA;&#x9;dataformDiagram.setOwnedByProject(project);&#xD;&#xA;&#x9;dataformDiagram.setItsDiagram(domainDiagram);&#xD;&#xA;&#x9;dataformDiagram.setName(&quot;model.tooldataform_diagram&quot;);&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;domainClass = tooldataform.pmoo.PmooFactory.eINSTANCE.createClase();&#xD;&#xA;&#x9;domainClass.setName(&quot;Domain&quot;);&#xD;&#xA;&#x9;domainDiagram.getListClase().add(domainClass);&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;project.getListDiagram().add(domainDiagram);&#xD;&#xA;&#x9;project.getListDataFormDiagram().add(dataformDiagram);&#xD;&#xA;&#x9;project.setTheModelFactory(modelFactory);&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;interface1.getListGraphicalContainer().add(container);&#xD;&#xA;&#x9;interface1.setName(reportName);&#xD;&#xA;&#x9;modelFactory.getListProyecto().add(project);"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="resetDataform">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;dataformDiagram.setTheInterface(null);&#xD;&#xA;&#x9;&#x9;salvarDF();&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="getOrderViewModel">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="               /*Se obtiene la ultima fila a analizar&#xD;&#xA;&#x9; *de la hoja&#xD;&#xA;&#x9; */&#xD;&#xA;&#x9;int nmax = sheet.getLastRowNum()+1;&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;//Objeto necesario para obtener una celda en el excel&#xD;&#xA;&#x9;XSSFCell c;&#xD;&#xA;&#x9;//Obejto necesario para obtener una fila en el excel&#xD;&#xA;&#x9;org.apache.poi.xssf.usermodel.XSSFRow r = null;&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;amountCombos = 0;&#xD;&#xA;&#x9;//Recorre la hoja hasta encontrar el primer Combo&#xD;&#xA;&#x9;for (int i = 0; i &lt;nmax; i++) {&#xD;&#xA;&#x9;&#x9;r =  sheet.getRow(i);&#xD;&#xA;    &#x9;if(r == null) continue;&#xD;&#xA;    &#x9;for (int j = 0; j &lt;r.getLastCellNum(); j++) {&#xD;&#xA;    &#x9;&#x9;c = r.getCell(j);&#xD;&#xA;            &#xD;&#xA;    &#x9;&#x9;if(c != null &amp;&amp; getCellValue(c).contains(&quot;*&quot;) ) { &#xD;&#xA;            &#x9;//Es combo          &#x9;&#x9;    &#x9;&#x9;&#x9;&#xD;&#xA;    &#x9;&#x9;&#x9;int id = Integer.parseInt( getCellValue(c).substring(2,getCellValue(c).length() -1 ) );&#xD;&#xA;    &#x9;&#x9;&#x9;&#xD;&#xA;    &#x9;&#x9;&#x9;//listComboCordinate.add(new Coordinate(i, j-1));&#xD;&#xA;    &#x9;&#x9;&#x9;amountContainers++;&#xD;&#xA;    &#x9;&#x9;&#x9;ArrayList&lt;Integer> aux = (ArrayList&lt;Integer>) visitedCells.get(i);&#xD;&#xA;    &#x9;&#x9;&#x9;aux.set(j, amountContainers);&#xD;&#xA;    &#x9;&#x9;&#x9;aux.set(j-1, amountContainers);&#xD;&#xA;    &#x9;&#x9;&#x9;&#xD;&#xA;    &#x9;&#x9;&#x9;c = r.getCell(j-1);&#xD;&#xA;    &#x9;&#x9;&#x9;&#xD;&#xA;    &#x9;&#x9;&#x9;comboNamesSorted.set(id-1, getCellValue(c));&#xD;&#xA;    &#x9;&#x9;&#x9;coordenadasComboBox.set(id-1, createCoordinate(i, j));&#xD;&#xA;    &#x9;&#x9;&#x9;&#xD;&#xA;    &#x9;&#x9;&#x9;coordenadasInicioContenedores.add(createCoordinate(i, j-1));&#xD;&#xA;    &#x9;    &#x9;coordenadasFinContenedores.add(createCoordinate(i, j));&#xD;&#xA;    &#x9;&#x9;&#x9;&#xD;&#xA;    &#x9;    &#x9;tooldataform.formmodel.concreta.ComboView combo =  tooldataform.formmodel.concreta.ConcretaFactory.eINSTANCE.createComboView();&#xD;&#xA;    &#x9;&#x9;&#x9;combo.setName(getCellValue(c));&#xD;&#xA;    &#x9;&#x9;&#x9;setBoundsGraphicalContainer(combo, 0 , 0, 240, 20);&#xD;&#xA;    &#x9;&#x9;&#x9;tooldataform.formmodel.concreta.ItemCombo item = tooldataform.formmodel.concreta.ConcretaFactory.eINSTANCE.createItemCombo();&#xD;&#xA;    &#x9;&#x9;&#x9;item.setName(&quot;nombre&quot;);&#xD;&#xA;    &#x9;&#x9;&#x9;combo.setTheItem(item);&#xD;&#xA;    &#x9;&#x9;&#x9;container .getListGraphicalContainer().add(combo);&#xD;&#xA;    &#x9;&#x9;&#x9;amountCombos++;&#xD;&#xA;            }&#xD;&#xA;        }&#xD;&#xA;    }&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;for(int i=0;i &lt; amountCombos ;i++ ){&#xD;&#xA;    &#x9;listComboBox.add((String) comboNamesSorted.get(i));&#xD;&#xA;&#x9;   &#x9;listComboCordinate.add((pgr.domain.util.impl.CoordinateImpl) coordenadasComboBox.get(i));&#xD;&#xA;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="getExtraInformation">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="        //Se recorre la hoja para extraer la futura &#xD;&#xA;        recorrerHoja();&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="identifyMergedRegions">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;//Obtiene la lista de merged regions de la hoja&#xD;&#xA;&#x9;&#x9;List sortedRegions = sheet.getMergedRegions();&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;&#x9;//Ordenamos de mayor a menor las regiones con respecto a las filas&#xD;&#xA;&#x9;&#x9;pgr.domain.util.impl.ComparatorRangeImpl c = (pgr.domain.util.impl.ComparatorRangeImpl) pgr.domain.util.UtilFactory.eINSTANCE.createComparatorRange();&#xD;&#xA;&#x9;&#x9;java.util.Collections.sort(sortedRegions, c );&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;//Inicializamos la estructura de datos que se tiene por conveniencia&#xD;&#xA;&#x9;&#x9;//y facilidad para manejar las regiones combinadas&#xD;&#xA;&#x9;&#x9;InitMergedRegions(sortedRegions);&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;//Se expoloran todas las regiones de la hoja&#xD;&#xA;&#x9;&#x9;for(int i=0;i&lt;sortedRegions.size();i++){&#xD;&#xA;&#x9;&#x9;&#x9;org.apache.poi.ss.util.CellRangeAddress range = (org.apache.poi.ss.util.CellRangeAddress) sortedRegions.get(i);  &#xD;&#xA;&#x9;&#x9;&#x9;ArrayList&lt;Integer> aux = (ArrayList&lt;Integer>) visitedCells.get(range.getFirstRow());&#xD;&#xA;&#x9;&#x9;&#x9;if(aux.get(range.getFirstColumn()) == 0){&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;String textRange = sheet.getRow(range.getFirstRow()).getCell(range.getFirstColumn()).getStringCellValue();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;MergedRegion mergeRegion = pgr.domain.util.UtilFactory.eINSTANCE.createMergedRegion();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;mergeRegion.MergedRegion(textRange, range.getFirstColumn(), range.getLastColumn(), &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;range.getFirstRow(), range.getLastRow());&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;containerEndRow= range.getFirstRow();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;containerEndCell= range.getFirstColumn();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;GraphicalContainer container = exploreMergedRegions(mergeRegion);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;this.container.getListGraphicalContainer().add(container);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;coordenadasInicioContenedores.add(createCoordinate(range.getFirstRow(), range.getFirstColumn()));&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;coordenadasFinContenedores.add(createCoordinate(containerEndRow, containerEndCell));&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;visitRegion(mergeRegion);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;amountContainers++;&#xD;&#xA;&#x9;&#x9;&#x9;}&#x9;&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="searchMergeRegion" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EBoolean">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;ArrayList&lt;MergedRegion> aux = (ArrayList&lt;MergedRegion>) mergedRegions.get(nextRow);&#xD;&#xA;&#x9;&#x9;for(int j=0; j &lt; aux.size(); j++){&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;MergedRegion nextMergeRegion = aux.get(j);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;if(nextMergeRegion.getFirstColumn() >= range.getFirstColumn() &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;&amp; nextMergeRegion.getFirstColumn() &lt;= range.getLastColumn()) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;return true;&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;return false;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="range" eType="#//domain/util/MergedRegion"/>
          <eParameters name="nextRow" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="exploreMergedRegions" eType="#//datatypes/datatypesdataform/GraphicalContainer">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;GraphicalContainer container =  tooldataform.formmodel.concreta.ConcretaFactory.eINSTANCE.createContainer();&#xD;&#xA;&#x9;&#x9;container.setName(range.getText());&#xD;&#xA;&#x9;&#x9;int firstRow = range.getFirstRow(), lastRow = range.getLastRow();&#xD;&#xA;&#x9;&#x9;int firstColumn = range.getFirstColumn(), lastColumn = range.getLastColumn();&#xD;&#xA;&#x9;&#x9;int nextRow = firstRow + (lastRow - firstRow+ 1);&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;ArrayList&lt;MergedRegion> aux = (ArrayList&lt;MergedRegion>) mergedRegions.get(nextRow);&#xD;&#xA;&#x9;&#x9;if(aux.size() == 0 || !searchMergeRegion(range, nextRow)) {&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;ArrayList&lt;String> columns = getTableColumns(range, nextRow);&#xD;&#xA;&#x9;&#x9;&#x9;TableView table = createTable(range, columns);&#xD;&#xA;&#x9;&#x9;&#x9;container.getListGraphicalContainer().add(table);&#xD;&#xA;&#x9;&#x9;&#x9;int deep = visitTable(range);&#xD;&#xA;&#x9;&#x9;&#x9;setBoundsGraphicalContainer(table, 15, 15, columns.size()*100 , (deep-range.getFirstRow())*20);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;tooldataform.formmodel.concreta.Containment c = tooldataform.formmodel.concreta.ConcretaFactory.eINSTANCE.createContainment();&#xD;&#xA;&#x9;&#x9;&#x9;setAtributesContaimentRelation(c,&quot;&quot;);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;//Se agrega el source y target de la relacion&#xD;&#xA;&#x9;&#x9;&#x9;c.getSource().add(container);&#xD;&#xA;&#x9;&#x9;&#x9;c.getTarget().add(table);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;setBoundsGraphicalContainer(container, 15, 15 ,  table.getWidth() + 40 , table.getHeight() + 40);&#xD;&#xA;&#x9;&#x9;&#x9;return container;&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;aux = (ArrayList&lt;MergedRegion>) mergedRegions.get(nextRow);&#xD;&#xA;&#x9;&#x9;for(int i=0; i &lt; aux.size();i++) {&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;MergedRegion nextMergeRegin = aux.get(i);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;if(nextMergeRegin.getFirstColumn()>=firstColumn &amp;&amp; nextMergeRegin.getLastColumn()&lt;=lastColumn){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if(!isTableColumn(nextMergeRegin)){ &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;//sevisita&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;visitRegion(nextMergeRegin);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;GraphicalContainer subContainer = exploreMergedRegions(nextMergeRegin);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;container.getListGraphicalContainer().add(subContainer);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;} else {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;//Se construye la tabla&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;//Se visita las tuplas de la tabla y los encabezaos&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;//Se agrega al contenedor y se retorna&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ArrayList&lt;String> columns = getTableColumns(range, nextRow);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;TableView table = createTable(range, columns);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;container.getListGraphicalContainer().add(table);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;int deep = visitTable(range);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;setBoundsGraphicalContainer(table, 15, 15, columns.size()*100 , (deep-range.getFirstRow())*20);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;tooldataform.formmodel.concreta.Containment c = tooldataform.formmodel.concreta.ConcretaFactory.eINSTANCE.createContainment();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;setAtributesContaimentRelation(c,&quot;&quot;);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;//Se agrega el source y target de la relacion&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;c.getSource().add(container);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;c.getTarget().add(table);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;setBoundsGraphicalContainer(container, 15, 15 ,  table.getWidth() + 40 , table.getHeight() + 40);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;break;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;int x  = container.getListGraphicalContainer().get(0).getWidth();&#xD;&#xA;&#x9;&#x9;int y  = container.getListGraphicalContainer().get(0).getPositionY();&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;x+= 15; y+= 15;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;&#x9;for(int i = 1  ;i &lt; container.getListGraphicalContainer().size();i++){&#xD;&#xA;&#x9;&#x9;&#x9;x+=40;&#xD;&#xA;&#x9;&#x9;&#x9;container.getListGraphicalContainer().get(i).setPositionX(x);&#xD;&#xA;&#x9;&#x9;&#x9;x+= container.getListGraphicalContainer().get(i).getWidth();&#xD;&#xA;&#x9;&#x9;&#x9;y = Math.max(y,  container.getListGraphicalContainer().get(i).getHeight());&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;x+=15;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;if(container.getListGraphicalContainer().size()>1)&#xD;&#xA;&#x9;&#x9;&#x9;setBoundsGraphicalContainer(container, 15, 15, x, y);&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;return container;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="range" eType="#//domain/util/MergedRegion"/>
        </eOperations>
        <eOperations name="visitTable" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;int fila=  region.getFirstRow();&#xD;&#xA;&#x9;&#x9;org.apache.poi.xssf.usermodel.XSSFRow r = sheet.getRow(fila);&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;int columa = region.getFirstColumn();&#xD;&#xA;&#x9;&#x9;XSSFCell c;&#xD;&#xA;&#x9;&#x9;while(r!=null){&#xD;&#xA;&#x9;&#x9;&#x9;c = r.getCell(columa);&#xD;&#xA;&#x9;&#x9;&#x9;if(c==null)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;break;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;ArrayList&lt;Integer> aux = (ArrayList&lt;Integer>) visitedCells.get(fila);&#xD;&#xA;&#x9;&#x9;&#x9;for(int i=columa; i &lt;= region.getLastColumn();i++){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;aux.set(i, amountContainers);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;containerEndRow = fila;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;containerEndCell = i;&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;r = sheet.getRow(++fila);&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;return fila;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="region" eType="#//domain/util/MergedRegion"/>
        </eOperations>
        <eOperations name="getTableColumns" eType="#//datatypes/datatypesjavautil/ArrayList">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;ArrayList&lt;String> columns = new ArrayList&lt;String>();&#xD;&#xA;&#x9;&#x9;String column;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;int i = region.getFirstColumn();&#xD;&#xA;&#x9;&#x9;while (i &lt;= region.getLastColumn()) {&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;column = sheet.getRow(nextRow).getCell(i).getStringCellValue();&#xD;&#xA;&#x9;&#x9;&#x9;columns.add(column);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;if(isCellRange(nextRow, i)) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;ArrayList&lt;MergedRegion> aux = (ArrayList&lt;MergedRegion>) mergedRegions.get(nextRow);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;for(int j=0; j &lt; aux.size(); j++){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;MergedRegion nextMergeRegion = aux.get(j);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if(nextMergeRegion.getFirstColumn()==i){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if(nextMergeRegion.getFirstColumn() == nextMergeRegion.getLastColumn()) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;i++;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;break;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;i += nextMergeRegion.getLastColumn() - i + 1;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;break;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;} else {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;i++;&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;return columns;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="region" eType="#//domain/util/MergedRegion"/>
          <eParameters name="nextRow" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="createTable" eType="#//datatypes/datatypesqm/TableView">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="//Se crea  la instancia de la tabla&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;TableView table = tooldataform.formmodel.concreta.ConcretaFactory.eINSTANCE.createTableView();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;table.setName(region.getText());&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;//Se agregan las colummnas a la tabla&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;for(int j=0;j&lt;columns.size();j++){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;tooldataform.formmodel.concreta.ColumView c= tooldataform.formmodel.concreta.ConcretaFactory.eINSTANCE.createColumView();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;c.setName((String)columns.get(j));&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;table.getListColumView().add(c);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;return table;"/>
          </eAnnotations>
          <eParameters name="region" eType="#//domain/util/MergedRegion"/>
          <eParameters name="columns" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        </eOperations>
        <eOperations name="isTableColumn" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EBoolean">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;int firstRow = mergeRegion.getFirstRow(), lastRow = mergeRegion.getLastRow();&#xD;&#xA;&#x9;&#x9;int firstColumn = mergeRegion.getFirstColumn(), lastColumn = mergeRegion.getLastColumn();&#xD;&#xA;&#x9;&#x9;int nextRow = firstRow + (lastRow - firstRow + 1);&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;ArrayList&lt;MergedRegion> aux = (ArrayList&lt;MergedRegion>) mergedRegions.get(nextRow);&#xD;&#xA;&#x9;&#x9;for(int i=0; i&lt; aux.size();i++){&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;MergedRegion nextMergeRegin = aux.get(i);&#xD;&#xA;&#x9;&#x9;&#x9;if(nextMergeRegin.getFirstColumn()==firstColumn &amp;&amp;  nextMergeRegin.getLastColumn()==lastColumn){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;return true;&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;if(firstColumn == lastColumn) return true;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;return false;"/>
          </eAnnotations>
          <eParameters name="mergeRegion" eType="#//domain/util/MergedRegion"/>
        </eOperations>
        <eOperations name="isTable" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EBoolean">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;ArrayList&lt;Integer> aux = (ArrayList&lt;Integer>) visitedCells.get(i);&#xD;&#xA;&#x9;&#x9;if(aux.get(j) >= 1 &amp;&amp; aux.get(j) &lt;= amountTables)&#xD;&#xA;&#x9;&#x9;&#x9;return true;&#xD;&#xA;&#x9;&#x9;return false;"/>
          </eAnnotations>
          <eParameters name="i" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="j" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="visitRegion">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;for(int i = mergeRegion.getFirstRow(); i &lt;= mergeRegion.getLastRow(); i++) {&#xD;&#xA;&#x9;&#x9;&#x9;ArrayList&lt;Integer> aux = (ArrayList&lt;Integer>) visitedCells.get(i);&#xD;&#xA;&#x9;&#x9;&#x9;for(int j = mergeRegion.getFirstColumn(); j &lt;= mergeRegion.getLastColumn(); j++)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;aux.set(j, amountContainers);&#xD;&#xA;&#x9;&#x9;}"/>
          </eAnnotations>
          <eParameters name="mergeRegion" eType="#//domain/util/MergedRegion"/>
        </eOperations>
        <eOperations name="InitMergedRegions">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="if(sortedRegions.size()==0)&#xD;&#xA;&#x9;&#x9;&#x9;return;&#xD;&#xA;&#x9;&#x9;mergedRegions = new ArrayList&lt;ArrayList&lt;MergedRegion>>();&#xD;&#xA;&#x9;&#x9;for (int i = 0; i &lt; ((org.apache.poi.ss.util.CellRangeAddressBase) sortedRegions.get(sortedRegions.size()-1)).getLastRow()+10; i++) {&#xD;&#xA;&#x9;&#x9;&#x9;mergedRegions.add(new ArrayList&lt;MergedRegion>());&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;for(int i=0;i&lt; sortedRegions.size();i++){&#xD;&#xA;&#x9;&#x9;&#x9;org.apache.poi.ss.util.CellRangeAddress range = (org.apache.poi.ss.util.CellRangeAddress) sortedRegions.get(i);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;String text = sheet.getRow(range.getFirstRow()).getCell(range.getFirstColumn()).getStringCellValue();&#xD;&#xA;&#x9;&#x9;&#x9;ArrayList&lt;MergedRegion> aux = (ArrayList&lt;MergedRegion>) mergedRegions.get(range.getFirstRow());&#xD;&#xA;&#x9;&#x9;&#x9;MergedRegion mergeRegion = pgr.domain.util.UtilFactory.eINSTANCE.createMergedRegion();&#xD;&#xA;&#x9;&#x9;&#x9;mergeRegion.MergedRegion(text, range.getFirstColumn(), range.getLastColumn(), &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;range.getFirstRow(), range.getLastRow());&#xD;&#xA;&#x9;&#x9;&#x9;aux.add(mergeRegion);&#xD;&#xA;&#x9;&#x9;}&#x9;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="sortedRegions" eType="#//datatypes/datatypesjavautil/List"/>
        </eOperations>
        <eOperations name="isCellRange" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EBoolean">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;ArrayList&lt;MergedRegion> aux = (ArrayList&lt;MergedRegion>) mergedRegions.get(i);&#xD;&#xA;&#x9;&#x9;if(aux.size()!=0){&#xD;&#xA;&#x9;&#x9;&#x9;for(int j=0;j&lt;aux.size();j++){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if(aux.get(j).getFirstColumn()&lt;= l &amp;&amp; aux.get(j).getLastColumn() >= l )&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;return true;&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;return false;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="i" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="l" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="getDimention" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;//Carga el xml del excel&#xD;&#xA;&#x9;&#x9;org.w3c.dom.Document doc = getXML(path+&quot;worksheets/sheet1.xml&quot;);&#xD;&#xA;&#x9;&#x9;doc.getDocumentElement().normalize();&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;//Obtiene el tag Dimension&#xD;&#xA;&#x9;&#x9;org.w3c.dom.NodeList nList = doc.getElementsByTagName(&quot;dimension&quot;);&#xD;&#xA;&#x9;&#x9;org.w3c.dom.Node node = nList.item(0);&#xD;&#xA;&#x9;&#x9;String s=&quot;&quot;;&#xD;&#xA;&#x9;&#x9;if(node.getNodeType()==org.w3c.dom.Node.ELEMENT_NODE){&#xD;&#xA;&#x9;&#x9;&#x9;org.w3c.dom.Element e = (org.w3c.dom.Element)node;&#xD;&#xA;&#x9;&#x9;&#x9;s = e.getAttribute(&quot;ref&quot;);&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;return s;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="getNumberTables" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;//Carga el xml del excel&#xD;&#xA;&#x9;&#x9;org.w3c.dom.Document doc = getXML(path+&quot;worksheets/sheet1.xml&quot;);&#xD;&#xA;&#x9;&#x9;doc.getDocumentElement().normalize();&#x9;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;//Obtiene el tag que contiene la lista de tablas&#xD;&#xA;&#x9;&#x9;org.w3c.dom.NodeList nList = doc.getElementsByTagName(&quot;tablePart&quot;);&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;return nList.getLength();&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="getTables">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;//Obtiene el numero de tablas a agregar al dataform&#xD;&#xA;&#x9;&#x9;int n = getNumberTables();&#xD;&#xA;&#x9;&#x9;amountTables =n;&#xD;&#xA;&#x9;&#x9;//Documento xml del excel&#xD;&#xA;&#x9;&#x9;org.w3c.dom.Document doc;&#xD;&#xA;&#x9;&#x9;for(int i=1;i&lt;=n;i++){&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;//Se crea el container que contendr? la tabla&#xD;&#xA;&#x9;&#x9;&#x9;tooldataform.formmodel.concreta.Container containerTablas = tooldataform.formmodel.concreta.ConcretaFactory.eINSTANCE.createContainer();&#xD;&#xA;&#x9;&#x9;&#x9;containerTablas.setName(&quot;Table&quot;+i);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;//Se lee el archivo xml relacionado con la tabla a analizar&#xD;&#xA;&#x9;&#x9;&#x9;doc = getXML(path +&quot;tables/table&quot;+i+&quot;.xml&quot;);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;//Se obtiene la dimension de la tabla&#xD;&#xA;&#x9;&#x9;&#x9;String s=&quot;&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;org.w3c.dom.NodeList es = doc.getElementsByTagName(&quot;autoFilter&quot;);&#xD;&#xA;&#x9;&#x9;&#x9;org.w3c.dom.Node node = es.item(0);&#xD;&#xA;&#x9;&#x9;&#x9;if(node.getNodeType()==org.w3c.dom.Node.ELEMENT_NODE){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;org.w3c.dom.Element e = (org.w3c.dom.Element)node;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;s = e.getAttribute(&quot;ref&quot;);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;listTables.add(s);&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;//Se extrae la dimencion de la tabla&#xD;&#xA;&#x9;&#x9;&#x9;String inicio = s.split(&quot;:&quot;)[0];&#xD;&#xA;&#x9;&#x9;&#x9;String fin = &#x9;s.split(&quot;:&quot;)[1];&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;//Se obtienen las coordenandas y el size de la tabla&#xD;&#xA;&#x9;&#x9;&#x9;pgr.domain.util.impl.CoordinateImpl coordinates=  (pgr.domain.util.impl.CoordinateImpl) getCoordinates(inicio);&#xD;&#xA;&#x9;&#x9;&#x9;pgr.domain.util.impl.CoordinateImpl size = (pgr.domain.util.impl.CoordinateImpl) getSizes(inicio, fin);&#xD;&#xA;&#x9;&#x9;&#x9;coordenadasInicioContenedores.add(coordinates);&#xD;&#xA;&#x9;&#x9;&#x9;coordenadasFinContenedores.add( getCoordinates(fin));&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;//Se obtienen las columnas&#xD;&#xA;&#x9;&#x9;&#x9;org.w3c.dom.NodeList nList = doc.getElementsByTagName(&quot;tableColumn&quot;);&#xD;&#xA;&#x9;&#x9;&#x9;ArrayList&lt;String> columnas = new ArrayList&lt;String>();&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;for (int j = 0; j &lt; nList.getLength(); j++) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;org.w3c.dom.Node nNode = nList.item(j);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if(nNode.getNodeType()==org.w3c.dom.Node.ELEMENT_NODE){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;org.w3c.dom.Element e = (org.w3c.dom.Element)nNode;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;columnas.add(e.getAttribute(&quot;name&quot;));&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;//Se crea  la instancia de la tabla&#xD;&#xA;&#x9;&#x9;&#x9;TableView tb = tooldataform.formmodel.concreta.ConcretaFactory.eINSTANCE.createTableView();&#xD;&#xA;&#x9;&#x9;&#x9;tb.setName(&quot;Table&quot;+i);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;//Se agregan las colummnas a la tabla&#xD;&#xA;&#x9;&#x9;&#x9;for(int j=0;j&lt;columnas.size();j++){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;tooldataform.formmodel.concreta.ColumView c = tooldataform.formmodel.concreta.ConcretaFactory.eINSTANCE.createColumView();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;c.setName(columnas.get(j));&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;tb.getListColumView().add(c);&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;//Se setean las dimensiones y posicion de la tabla&#xD;&#xA;&#x9;&#x9;&#x9;setBoundsGraphicalContainer(tb, 15, 15, size.getX()+10, size.getY());&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;//Se setean las dimensiones y posicion del contenedor&#xD;&#xA;&#x9;&#x9;&#x9;setBoundsGraphicalContainer(containerTablas,coordinates.getX() - relativeX , coordinates.getY() - relativeY ,size.getX() + 40, size.getY() + 40);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;//Se agrega la tabla al contenedor&#xD;&#xA;&#x9;&#x9;&#x9;containerTablas.getListGraphicalContainer().add(tb);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;//Se crea la relacion de contaiment para que la tabla se pueda visualizar&#xD;&#xA;&#x9;&#x9;&#x9;tooldataform.formmodel.concreta.Containment c = tooldataform.formmodel.concreta.ConcretaFactory.eINSTANCE.createContainment();&#xD;&#xA;&#x9;&#x9;&#x9;setAtributesContaimentRelation(c,&quot;&quot; + i);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;//Se agrega el source y target de la relacion&#xD;&#xA;&#x9;&#x9;&#x9;c.getSource().add(containerTablas);&#xD;&#xA;&#x9;&#x9;&#x9;c.getTarget().add(tb);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;//Se agrega la relacion  al diagrama&#xD;&#xA;&#x9;&#x9;&#x9;dataformDiagram.getListarelacion().add(c);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;containers.add(containerTablas);&#xD;&#xA;&#x9;&#x9;&#x9;//Se agrega el contendor a la interfaz &#xD;&#xA;&#x9;&#x9;&#x9;container.getListGraphicalContainer().add(containerTablas);&#xD;&#xA;&#x9;&#x9;}&#x9;&#x9;&#xD;&#xA;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="salvarDF">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;org.eclipse.emf.common.util.URI uri = org.eclipse.emf.common.util.URI.createURI(&quot;platform:/resource/PGR/domain/model.tooldataform&quot;);&#xD;&#xA;&#x9;&#x9;org.eclipse.emf.ecore.resource.ResourceSet resourceSet= new org.eclipse.emf.ecore.resource.impl.ResourceSetImpl();&#xD;&#xA;&#x9;&#x9;org.eclipse.emf.ecore.resource.Resource resource = resourceSet.createResource(uri);&#xD;&#xA;&#x9;&#x9;resource.getContents().add(modelFactory);&#xD;&#xA;&#x9;&#x9;try {&#xD;&#xA;&#x9;&#x9;&#x9;resource.save(java.util.Collections.EMPTY_MAP);&#xD;&#xA;&#x9;&#x9;} catch (java.io.IOException e) {&#xD;&#xA;&#x9;&#x9;&#x9;e.printStackTrace();&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="getXML" eType="#//datatypes/Document">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#x9;&#x9;&#x9;&#x9;try {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;java.io.File fXmlFile = new java.io.File(url);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;javax.xml.parsers.DocumentBuilderFactory dbFactory = javax.xml.parsers.DocumentBuilderFactory.newInstance();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;javax.xml.parsers.DocumentBuilder dBuilder;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;dBuilder = dbFactory.newDocumentBuilder();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;org.w3c.dom.Document doc;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;doc = dBuilder.parse(fXmlFile);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;return doc;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;} catch (javax.xml.parsers.ParserConfigurationException e) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;// TODO Auto-generated catch block&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;e.printStackTrace();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}catch (org.xml.sax.SAXException | java.io.IOException e) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;// TODO Auto-generated catch block&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, &quot;Debe seleccionar primero el archivo al &quot;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  + &quot;cual se le capturara el modelo mental.&quot;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  , null, javax.swing.JOptionPane.ERROR_MESSAGE);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;return null;"/>
          </eAnnotations>
          <eParameters name="url" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        </eOperations>
        <eOperations name="marcarTablas">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;       &#xD;&#xA;        for(int i=0;i&lt;sizes.size();i++){&#xD;&#xA;        &#x9;//Se obtiene la dimension de la tabla que viene en formato &quot;CeldaInicio:CeldaFinal&quot; ejemplo: C1:P44&#xD;&#xA;        &#x9;String inicio = ( (String) sizes.get(i) ).split(&quot;:&quot;)[0], fin = ( (String) sizes.get(i) ).split(&quot;:&quot;)[1];&#xD;&#xA;        &#x9;&#xD;&#xA;        &#x9;&#xD;&#xA;        &#x9;//Se recorre las filas de la dimension&#xD;&#xA;        &#x9;for(int  j = Integer.parseInt(capturarNumeros(inicio))-1 ; j &lt;Integer.parseInt(capturarNumeros(fin)) ;j++){&#xD;&#xA;        &#x9;&#x9;&#xD;&#xA;        &#x9;&#x9;//Se obtiene la columna inicial y final&#xD;&#xA;        &#x9;&#x9;int wf= toInt(stractColumn(fin))-1;&#xD;&#xA;        &#x9;&#x9;int wi = toInt(stractColumn(inicio))-1;&#xD;&#xA;        &#x9;&#x9;&#xD;&#xA;        &#x9;&#x9;//Se recorre las columnas de la dimension&#xD;&#xA;        &#x9;&#x9;ArrayList&lt;Integer> aux = (ArrayList&lt;Integer>) visitedCells.get(j);&#xD;&#xA;        &#x9;&#x9;for(int k = wi; k &lt;= wf;k++ ){&#xD;&#xA;        &#x9;&#x9;&#x9;aux.set(k, amountContainers);&#xD;&#xA;        &#x9;&#x9;}&#xD;&#xA;        &#x9;}&#xD;&#xA;        &#x9;amountContainers++;&#xD;&#xA;        }&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="sizes" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        </eOperations>
        <eOperations name="reOrganizarTablas">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;for(int i=0;i&lt;coordenadasInicioContenedores.size();i++){&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;int x = ((pgr.domain.util.impl.CoordinateImpl) coordenadasInicioContenedores.get(i) ).getX();&#xD;&#xA;&#x9;&#x9;&#x9;int y = ((pgr.domain.util.impl.CoordinateImpl) coordenadasInicioContenedores.get(i)).getY();&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;int h = getAmountContainersH(y);&#xD;&#xA;&#x9;&#x9;&#x9;int v = getAmountContainersV(x);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;int c = calculateV(x);&#xD;&#xA;&#x9;&#x9;&#x9;int b = calculateH(y);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;ArrayList&lt;Integer> aux = (ArrayList&lt;Integer>) visitedCells.get(x);&#xD;&#xA;&#x9;&#x9;&#x9;int contenedor = aux.get(y)-1;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;int xs= h*100 + 40;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;if(h>0)&#xD;&#xA;&#x9;&#x9;&#x9; xs+=(b) +  ( (y-h-relativeY)*40);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;int ys = (v*20)+ 25;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;int s  = (x-v-relativeX);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;if(v>0)&#xD;&#xA;&#x9;&#x9;&#x9; ys+= c + (s* 15);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;container.getListGraphicalContainer().get(contenedor).setPositionX(xs);&#xD;&#xA;&#x9;&#x9;&#x9;container.getListGraphicalContainer().get(contenedor).setPositionY(ys);&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="getMaxX" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="int max = -1;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;for(int i=0;i&lt;a.size();i++){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if( ((pgr.domain.util.impl.CoordinateImpl)a.get(i) ).getX() > max){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;max = ((pgr.domain.util.impl.CoordinateImpl) a.get(i) ).getY();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;return max;"/>
          </eAnnotations>
          <eParameters name="a" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        </eOperations>
        <eOperations name="isValid" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EBoolean">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;ArrayList&lt;Integer> aux = (ArrayList&lt;Integer>) visitedCells.get(0);&#xD;&#xA;&#x9;&#x9;if(i >= 0 &amp;&amp; i &lt; visitedCells.size()  &amp;&amp; j >= 0 &amp;&amp; j &lt; aux.size())&#xD;&#xA;&#x9;&#x9;&#x9;return true;&#xD;&#xA;&#x9;&#x9;return false;"/>
          </eAnnotations>
          <eParameters name="i" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="j" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="bfs" eType="#//datatypes/datatypesjavautil/ArrayList">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;//Se extrae la fila y columna inicial&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;org.apache.poi.xssf.usermodel.XSSFRow r = sheet.getRow(i);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;XSSFCell c = r.getCell(j);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;//Arreglo que contiene las celdas visitadas en la exploracion&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;ArrayList&lt;pgr.domain.util.impl.CoordinateImpl> res = new ArrayList&lt;pgr.domain.util.impl.CoordinateImpl>();&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;//Se prepara la fila y columna en el excel de visitados&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;ArrayList&lt;Integer> aux = (ArrayList&lt;Integer>) visitedCells.get(i);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;aux.set(j, amountContainers);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;//Agregamos la posicion inicial al arreglo de celdas a retornar&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;res.add((pgr.domain.util.impl.CoordinateImpl)createCoordinate(i, j));&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;//Cola que contendran las celdas a analizar&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;java.util.Queue&lt;XSSFCell> q =   new java.util.LinkedList&lt;XSSFCell>();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;q.add(c);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;/*&#xD;&#xA;&#x9;&#x9;&#x9;&#x9; *Mientras que haya celdas a analizar&#xD;&#xA;&#x9;&#x9;&#x9;&#x9; *Se analizaran sus adyacencias para &#xD;&#xA;&#x9;&#x9;&#x9;&#x9; *encontrar mas celdas No nulas&#xD;&#xA;&#x9;&#x9;&#x9;&#x9; */&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;while (!q.isEmpty()) {&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;XSSFCell u = q.peek();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;q.poll();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;//Se observan las adyacencias de esta celda&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;//Las adyancencias de una celda son&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;//Arriba, Abajo, Izquierda y Derecha&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;for(int k = 0; k &lt; 4; k++) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;//Se obtiene la posible adyacencia en x y en y&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;int vx = u.getRowIndex()    + (int) adjacenciesX.get(k);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;int vy = u.getColumnIndex() + (int) adjacenciesY.get(k);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;//Se verifica si es  una adyacencia valida&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if(isValid(vx, vy)){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;//Si la fila no esta creada en el original&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;//No se analiza&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;r = sheet.getRow(vx);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if(r==null) continue;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;c = r.getCell(vy);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;//Si la celda no esta creada o esta vacia NO se analiza&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if (c !=null &amp;&amp; c.getCellType()!=XSSFCell.CELL_TYPE_BLANK ) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;//Se marca en el excel de visitados esta celda &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;//Como analizada para no analizarla mas&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;aux = (ArrayList&lt;Integer>) visitedCells.get(vx);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if(aux.get(vy) == 0){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;aux.set(vy, amountContainers);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;//Se agrega a lista la celda (vx,vy) como celda&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;//No NULA y NO VACIA&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;res.add((pgr.domain.util.impl.CoordinateImpl)createCoordinate(vx, vy));&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;q.add(c);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;amountContainers++;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;return res;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="i" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="j" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="recorrerHoja">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;//Se obtiene la ultima fila a anlizar&#xD;&#xA;&#x9;&#x9;int nmax = sheet.getLastRowNum()+1;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;for (int i = 0; i &lt;nmax; i++) {&#xD;&#xA;&#x9;    &#x9;&#xD;&#xA;&#x9;&#x9;&#x9;//Si la fila no esta creada en el libro orignial, no se analiza y se continua&#xD;&#xA;&#x9;&#x9;&#x9;org.apache.poi.xssf.usermodel.XSSFRow r =  sheet.getRow(i);&#xD;&#xA;&#x9;    &#x9;if(r==null) continue;&#xD;&#xA;&#x9;    &#x9;&#xD;&#xA;&#x9;    &#x9;//Se recorre la fila hasta la ultima columna NO NULA&#xD;&#xA;&#x9;    &#x9;for (int j = 0; j &lt;r.getLastCellNum(); j++) {&#xD;&#xA;&#x9;    &#x9;&#x9;&#xD;&#xA;&#x9;    &#x9;&#x9;//Se obtienen las celdas del original y el visitado en la posicion J&#xD;&#xA;&#x9;    &#x9;&#x9;XSSFCell c = r.getCell(j);&#xD;&#xA;&#x9;    &#x9;&#x9;&#xD;&#xA;&#x9;    &#x9;&#x9;//Si la celda es nula en el original no se analiza y se continua&#xD;&#xA;&#x9;    &#x9;&#x9;ArrayList&lt;Integer> aux = (ArrayList&lt;Integer>) visitedCells.get(i);&#xD;&#xA;&#x9;            if(c != null &amp;&amp; aux.get(j) == 0) { &#xD;&#xA;&#x9;            &#x9;&#xD;&#xA;&#x9;            &#x9;//Si la celda esta vacia no se analiza y se continua &#xD;&#xA;&#x9;            &#x9;if(c.getCellType()==XSSFCell.CELL_TYPE_BLANK)&#xD;&#xA;&#x9;            &#x9;&#x9;continue;&#xD;&#xA;&#x9;            &#x9;&#xD;&#xA;&#x9;            &#x9;tooldataform.formmodel.concreta.Container containerTablas = createContainer(i, j);&#xD;&#xA;&#x9;            &#x9;&#xD;&#xA;&#x9;         &#x9;&#x9;container.getListGraphicalContainer().add(containerTablas);&#xD;&#xA;&#x9;            }&#xD;&#xA;&#x9;        }&#xD;&#xA;&#x9;    }&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;//Se reorganizan las tablas&#xD;&#xA;&#x9;&#x9;reOrganizarTablas();&#xD;&#xA;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="createContainer" eType="#//datatypes/datatypesdataform/Container">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;//Se crea la instancia del contendor a agregar&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;tooldataform.formmodel.concreta.Container containerTablas = tooldataform.formmodel.concreta.ConcretaFactory.eINSTANCE.createContainer();&#xD;&#xA;&#x9;&#x9;&#x9;    containerTablas.setName(&quot;Container&quot;+ (amountContainers));&#xD;&#xA;&#x9;&#x9;&#x9;    &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;//Se ejecuta el BFS con el fin de buscar &#xD;&#xA;&#x9;&#x9;    &#x9;//Mas celdas no nulas &#xD;&#xA;&#x9;&#x9;    &#x9;//Para almacenarlas en un mismo contendor&#xD;&#xA;&#x9;&#x9;    &#x9;ArrayList&lt;pgr.domain.util.impl.CoordinateImpl> res = bfs( i, j);&#xD;&#xA;&#x9;&#x9;    &#x9;&#xD;&#xA;&#x9;&#x9;    &#x9;//Se ordenan las celdas encontradas&#xD;&#xA;&#x9;&#x9;    &#x9;java.util.Collections.sort(res);&#xD;&#xA;&#x9;&#x9;    &#x9;&#x9;&#xD;&#xA;&#x9;&#x9;    &#x9;int m = res.size(); &#x9;&#xD;&#xA;&#x9;&#x9;    &#x9;coordenadasInicioContenedores.add(createCoordinate(i, j));&#xD;&#xA;&#x9;&#x9;    &#x9;coordenadasFinContenedores.add(res.get(m-1));&#xD;&#xA;&#x9;&#x9;    &#x9;&#xD;&#xA;&#x9;&#x9;    &#x9;//Se extraen las dimenciones del contenedor que contendra a las celdas encontradas&#xD;&#xA;&#x9;&#x9;    &#x9;String key =res.get(0).getX() +&quot;-&quot;+ res.get(0).getY() +&quot;:&quot; + res.get(m-1).getX() +&quot;-&quot; + res.get(m-1).getY();&#xD;&#xA;&#x9;&#x9;    &#x9;    &#xD;&#xA;&#x9;&#x9;    &#x9;//Se delimita el inicio y el final del conentendor&#xD;&#xA;&#x9;&#x9;    &#x9;String inicio = key.split(&quot;:&quot;)[0]; String fin  = key.split(&quot;:&quot;)[1];&#xD;&#xA;&#x9;&#x9;    &#x9;&#x9;&#xD;&#xA;&#x9;&#x9;    &#x9;pgr.domain.util.impl.CoordinateImpl size = (pgr.domain.util.impl.CoordinateImpl) getSizes2(inicio, fin);&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;//Se setean los bounds al contenedor se deja en la posicion 0 0&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;setBoundsGraphicalContainer(containerTablas,0 , 0,  size.getX() + 20, size.getY() + 40);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;//Posiciones relativas para el contenido del contenedor&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;pgr.domain.util.impl.CoordinateImpl relativo =(pgr.domain.util.impl.CoordinateImpl) getCoordinates2( ((pgr.domain.util.impl.CoordinateImpl)res.get(0)).getX() +&quot;-&quot; +  ( (pgr.domain.util.impl.CoordinateImpl) res.get(0) ).getY()   );&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;int relativex = relativo.getX();&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;int relativey = relativo.getY();&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;for(int k=0;k&lt;m;k++){&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;//Se obtiene el X y el Y del componente &#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;int x = res.get(k).getX();    int y = res.get(k).getY();&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;//Se obtiene su valor&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;org.apache.poi.xssf.usermodel.XSSFRow rr = sheet.getRow(x);&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;XSSFCell  cc = rr.getCell(y);&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;String e = getCellValue(cc);&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;//Se Obtienen las coordenadas NO Relativas al contenedor&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;pgr.domain.util.impl.CoordinateImpl cor =(pgr.domain.util.impl.CoordinateImpl) getCoordinates2(x+&quot;-&quot;+y);&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;//Se crea la instancia del label&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;tooldataform.formmodel.concreta.LabelView label = tooldataform.formmodel.concreta.ConcretaFactory.eINSTANCE.createLabelView();&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;label.setName(e);&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;//Se setean los bounds&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;label.setId(&quot;label&quot;+ (char)(k+64));&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;label.setWidth(new Integer(-1));&#xD;&#xA;&#x9;&#x9;    &#x9;&#x9;label.setHeight(new Integer(-1));&#xD;&#xA;&#x9;&#x9;    &#x9;&#x9;label.setPositionX(new Integer(cor.getX() - relativex + 20 ));&#xD;&#xA;&#x9;&#x9;    &#x9;&#x9;label.setPositionY(new Integer(cor.getY() - relativey + 10));&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;    &#x9;&#x9;//Se agrega al contenedor&#xD;&#xA;&#x9;&#x9;    &#x9;&#x9;containerTablas.getListIndividualElementDataForm().add(label);&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;}&#xD;&#xA;&#x9;&#x9; &#x9;&#x9;return containerTablas;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="i" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="j" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="getAmountContainersV" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;int res=0;&#xD;&#xA;&#x9;&#x9;for(int i = y-1; i >= 0; i--) {&#xD;&#xA;&#x9;&#x9;&#x9;ArrayList&lt;Integer> aux = (ArrayList&lt;Integer>) visitedCells.get(i);&#xD;&#xA;&#x9;&#x9;&#x9;for(int j = 0; j &lt; aux.size(); j++)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if(aux.get(j) != 0){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;res++;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;break;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;return res;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="y" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="calculateV" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="int res=0;&#xD;&#xA;&#x9;&#x9;for(int i = y-1; i >= 0; i--) {&#xD;&#xA;&#x9;&#x9;&#x9;ArrayList&lt;Integer> aux = (ArrayList&lt;Integer>) visitedCells.get(i);&#xD;&#xA;&#x9;&#x9;&#x9;for(int j = 0; j &lt; aux.size(); j++)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if(aux.get(j) != 0){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if(((pgr.domain.util.impl.CoordinateImpl) coordenadasFinContenedores.get(aux.get(j)-1)).getX()== i){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; i = ((pgr.domain.util.impl.CoordinateImpl) coordenadasInicioContenedores.get(aux.get(j)-1)).getX();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; res+=40;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; break;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9; }&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;return res;"/>
          </eAnnotations>
          <eParameters name="y" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="calculateH" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;ArrayList&lt;Integer> aux = (ArrayList&lt;Integer>) visitedCells.get(0);&#xD;&#xA;&#x9;&#x9;int [][] matriz = new int[visitedCells.size()][aux.size()];  &#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;for (int i = 0; i &lt; matriz.length; i++) {&#xD;&#xA;&#x9;&#x9;&#x9;aux = (ArrayList&lt;Integer>) visitedCells.get(i);&#xD;&#xA;&#x9;&#x9;&#x9;for (int j = 0; j &lt; matriz[0].length; j++) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;matriz[i][j] = aux.get(j);&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;int res = 0;&#x9;&#xD;&#xA;&#x9;&#x9;for(int i = x-1; i >= 0; i--)&#xD;&#xA;&#x9;&#x9;&#x9;for(int j = 0; j &lt; matriz.length; j++)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if(matriz[j][i]!=0){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if(((pgr.domain.util.impl.CoordinateImpl) coordenadasFinContenedores.get(matriz[j][i]-1)).getY()== i){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; i = ((pgr.domain.util.impl.CoordinateImpl) coordenadasInicioContenedores.get(matriz[j][i]-1)).getY();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; res+=40;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; break;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9; }&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;return res;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="x" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="getAmountContainersH" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;ArrayList&lt;Integer> aux = (ArrayList&lt;Integer>) visitedCells.get(0);&#xD;&#xA;&#x9;&#x9;int [][] matriz = new int[visitedCells.size()][aux.size()];  &#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;for (int i = 0; i &lt; matriz.length; i++) {&#xD;&#xA;&#x9;&#x9;&#x9;aux = (ArrayList&lt;Integer>) visitedCells.get(i);&#xD;&#xA;&#x9;&#x9;&#x9;for (int j = 0; j &lt; matriz[0].length; j++) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;matriz[i][j] = aux.get(j);&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;int res=0;&#x9;&#xD;&#xA;&#x9;&#x9;for(int i = x-1; i >= 0; i--)&#xD;&#xA;&#x9;&#x9;&#x9;for(int j = 0; j &lt; matriz.length; j++)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if(matriz[j][i]!=0){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;res++;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;break;&#xD;&#xA;&#x9;&#x9;&#x9;    }&#xD;&#xA;&#x9;&#x9;return res;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="x" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="capturarNumeros" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;int i=0;&#xD;&#xA;&#x9;&#x9;for(;i&lt;s.length();i++){&#xD;&#xA;&#x9;&#x9;&#x9;if( s.charAt(i) >= 65 &amp;&amp; s.charAt(i)&lt;=90){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;continue;&#xD;&#xA;&#x9;&#x9;&#x9;}else{&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;break;&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;return s.substring(i);&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="s" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        </eOperations>
        <eOperations name="getCoordinates" eType="#//domain/util/Coordinate">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="int w = toInt(stractColumn(inicio))-1;&#xD;&#xA;&#x9;&#x9;&#x9;int h = ( Integer.parseInt(capturarNumeros(inicio))-1);&#xD;&#xA;&#x9;&#x9;&#x9;pgr.domain.util.impl.CoordinateImpl c = (pgr.domain.util.impl.CoordinateImpl)createCoordinate(h, w);&#xD;&#xA;&#x9;&#x9;&#x9;return c;"/>
          </eAnnotations>
          <eParameters name="inicio" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        </eOperations>
        <eOperations name="getSizes" eType="#//domain/util/Coordinate">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#x9;&#x9;int wf= toInt(stractColumn(fin))-1;&#xD;&#xA;&#x9;&#x9;int wi = toInt(stractColumn(inicio))-1;&#xD;&#xA;&#x9;&#x9;int w = ( wf - wi + 1)*100;&#xD;&#xA;&#x9;&#x9;int h = ( Integer.parseInt(capturarNumeros(fin)) - Integer.parseInt(capturarNumeros(inicio)) + 1)*20;  &#xD;&#xA;&#x9;&#x9;return createCoordinate(w,h);&#x9;&#x9;&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="inicio" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
          <eParameters name="fin" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        </eOperations>
        <eOperations name="stractColumn" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;String res=&quot;&quot;;&#xD;&#xA;&#x9;&#x9;for(int i=0;i&lt;s.length();i++){&#xD;&#xA;&#x9;&#x9;&#x9;if( s.charAt(i) >= 65 &amp;&amp; s.charAt(i)&lt;=90){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;res+= s.charAt(i);&#xD;&#xA;&#x9;&#x9;&#x9;}else{&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;break;&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;return res;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="s" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        </eOperations>
        <eOperations name="getSizes2" eType="#//domain/util/Coordinate">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="String ws1 = inicio.split(&quot;-&quot;)[1];  String hs1 = inicio.split(&quot;-&quot;)[0];&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;String ws2 = fin.split(&quot;-&quot;)[1];     String hs2 = fin.split(&quot;-&quot;)[0];&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;int w = ( (Integer.parseInt(ws2))  -  (Integer.parseInt(ws1)) + 1 )*100;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;int h = ( Integer.parseInt(hs2) - Integer.parseInt((hs1)) + 1)*20 ;  &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;return createCoordinate(w, h);"/>
          </eAnnotations>
          <eParameters name="inicio" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
          <eParameters name="fin" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        </eOperations>
        <eOperations name="getCoordinates2" eType="#//domain/util/Coordinate">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="String ws = inicio.split(&quot;-&quot;)[1];&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;String hs = inicio.split(&quot;-&quot;)[0];&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;int w = Integer.parseInt(ws)*80;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;int h = Integer.parseInt(hs)*20;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;return createCoordinate(w, h);"/>
          </eAnnotations>
          <eParameters name="inicio" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        </eOperations>
        <eOperations name="toInt" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;int res =0;&#xD;&#xA;&#x9;&#x9;int m = s.length()-1;&#xD;&#xA;&#x9;&#x9;int e=0;&#xD;&#xA;&#x9;&#x9;for(int i=m;i>=0;i--){&#xD;&#xA;&#x9;&#x9;&#x9;res += ( (s.charAt(i) - 64))*pow(26,e);&#xD;&#xA;&#x9;&#x9;&#x9;e++;&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;return res;"/>
          </eAnnotations>
          <eParameters name="s" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        </eOperations>
        <eOperations name="pow" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;int res =1;&#x9;&#xD;&#xA;&#x9;&#x9;for(int i=0;i&lt;e;i++){&#xD;&#xA;&#x9;&#x9;&#x9;res*=b;&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;return res;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="b" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="e" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="getCellValue" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;int cel_Type = cell.getCellType();                           &#xD;&#xA;&#x9;     String res=&quot;&quot;;&#xD;&#xA;&#x9;&#x9; switch(cel_Type){&#xD;&#xA;&#x9;     &#x9;case 0: res+=cell.getNumericCellValue();&#xD;&#xA;&#x9;             &#x9;break;&#xD;&#xA;&#x9;     &#x9;case 1: res+=cell.getStringCellValue();&#xD;&#xA;&#x9;     &#x9;&#x9;&#x9;break;&#xD;&#xA;&#x9;     &#x9;case 4:res+=cell.getBooleanCellValue();&#xD;&#xA;&#x9;             &#x9;break;&#xD;&#xA;&#x9;     &#x9;case 3:res+=&quot;&quot;;&#xD;&#xA;&#x9;     &#x9;&#x9;&#x9;break; &#xD;&#xA;&#x9;     }&#xD;&#xA;&#x9;&#x9; return res;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="cell" eType="#//datatypes/datatypeapachepoi/XSSFCell"/>
        </eOperations>
        <eOperations name="createCoordinate" eType="#//domain/util/Coordinate">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="pgr.domain.util.impl.CoordinateImpl c = (pgr.domain.util.impl.CoordinateImpl)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9; pgr.domain.util.UtilFactory.eINSTANCE.createCoordinate();&#xD;&#xA;&#x9;&#x9; c.setX(x); c.setY(y);&#xD;&#xA;&#x9;&#x9;return c;"/>
          </eAnnotations>
          <eParameters name="x" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="y" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="modelFactory" eType="#//datatypes/datatypesdataform/ModelFactory"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="project" eType="#//datatypes/datatypesdataform/Project"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="dataformDiagram" eType="#//datatypes/datatypesdataform/DataForm_Diagram"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="domainDiagram" eType="#//datatypes/datatypesdataform/Domain_Diagram"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="domainClass" eType="#//datatypes/datatypesdataform/Clase"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="interface1" eType="#//datatypes/datatypesdataform/Interface"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="container" eType="#//datatypes/datatypesdataform/Container"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="path" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="absolutePath" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="dimens" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="amountContainers" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="amountTables" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="relativeX" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="relativeY" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="dataStartRow" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="dataStartCell" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="amountCombos" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="reportName" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="containerEndRow" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="containerEndCell" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="workbook" eType="#//datatypes/datatypeapachepoi/XSSFWorkbook"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="sheet" eType="#//datatypes/datatypeapachepoi/XSSFSheet"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="adjacenciesX" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="adjacenciesY" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="visitedCells" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="comboNamesSorted" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="coordenadasComboBox"
            eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="listTables" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="listComboBox" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="listComboCordinate"
            eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="mergedRegions" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="coordenadasInicioContenedores"
            eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="coordenadasFinContenedores"
            eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="containers" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EReference" name="theDomain" eType="#//domain/Domain"
            transient="true" eOpposite="#//domain/Domain/theDataformGenerator"/>
      </eClassifiers>
      <eClassifiers xsi:type="ecore:EClass" name="ExcelGenerator">
        <eOperations name="ExcelGenerator">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;this.absolutePath = absolutePath;&#xD;&#xA;&#x9;&#x9;&#x9;this.namesFilters = listFilter;&#xD;&#xA;&#x9;&#x9;&#x9;this.posFilters = posFilters;&#xD;&#xA;&#x9;&#x9;&#x9;this.posRowIniData = posRowIniData;&#xD;&#xA;&#x9;&#x9;&#x9;this.posCellIniData = posCellIniData;&#xD;&#xA;&#x9;&#x9;&#x9;this.queryString = queryString;&#xD;&#xA;&#x9;&#x9;&#x9;firstRowFilter = 2;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;titlesMap = new HashMap&lt;String, Integer>();&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;tuplesList = new ArrayList&lt;String>();&#xD;&#xA;&#x9;&#x9;&#x9;columns  =    new ArrayList&lt;String>();&#xD;&#xA;&#x9;&#x9;&#x9;columnsNames = new ArrayList&lt;String>();&#xD;&#xA;&#x9;&#x9;&#x9;columnsIndex = new ArrayList&lt;Integer>();&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;this.modelFactoryQM = modelFactoryQM;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;result = modelFactoryQM.getFactoryModeloConsultas().getListModeloConsulta().get(0).getListResultado().get(0);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;workbook = readFile();&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;createSheetQuery();&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="absolutePath" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
          <eParameters name="listFilter" eType="#//datatypes/datatypesjavautil/ArrayList"/>
          <eParameters name="posFilters" eType="#//datatypes/datatypesjavautil/ArrayList"/>
          <eParameters name="modelFactoryQM" eType="#//datatypes/datatypesqm/ModelFactory"/>
          <eParameters name="posRowIniData" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="posCellIniData" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="queryString" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        </eOperations>
        <eOperations name="ExcelGenerator">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;this.absolutePath = absolutePath;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;this.namesFilters=listFilter;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;this.posFilters = posFilters;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;posCellIniData = ( (pgr.domain.util.impl.CoordinateImpl)posFilters.get( posFilters.size()-1)).getY();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;posRowIniData  = ( (pgr.domain.util.impl.CoordinateImpl)posFilters.get( posFilters.size()-1)).getX();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;this.posFilters.remove(posFilters.size()-1);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;columnsNames = new ArrayList&lt;String>();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;columnsIndex = new ArrayList&lt;Integer>();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;tuplesList = new ArrayList&lt;String>();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;titlesMap = new HashMap&lt;String, Integer>();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;firstRowFilter = 2;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="absolutePath" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
          <eParameters name="listFilter" eType="#//datatypes/datatypesjavautil/ArrayList"/>
          <eParameters name="posFilters" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        </eOperations>
        <eOperations name="createRelations">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;sheet = workbook.getSheetAt(0);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;if(workbook.getSheet(&quot;Datos&quot;)==null){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;newDataSheet = workbook.createSheet(&quot;Datos&quot;);&#xD;&#xA;&#x9;&#x9;&#x9;}else{&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;workbook.removeSheetAt(workbook.getSheetIndex(&quot;Datos&quot;));&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;newDataSheet = workbook.createSheet(&quot;Datos&quot;);&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;resultSet = getResulSet(dataSheet);&#xD;&#xA;&#x9;&#x9;&#x9;createNames();&#xD;&#xA;&#x9;&#x9;&#x9;init();&#xD;&#xA;&#x9;&#x9;&#x9;workbook.setActiveSheet(0);&#xD;&#xA;&#x9;&#x9;&#x9;sheet.showInPane(0, 0);&#xD;&#xA;&#x9;&#x9;&#x9;saveExcel();&#xD;&#xA;&#x9;&#x9;&#x9;execute(namesFilters, titlesMap, acc, posRowIniData, posCellIniData);&#xD;&#xA;&#x9;&#x9;&#x9;workbook.setSheetHidden(workbook.getSheetIndex(&quot;Query&quot;), true);&#xD;&#xA;&#x9;&#x9;&#x9;workbook.setSheetHidden(workbook.getSheetIndex(&quot;ResultSet&quot;), true);&#xD;&#xA;&#x9;&#x9;&#x9;workbook.setSheetHidden(workbook.getSheetIndex(&quot;Datos&quot;), true);&#xD;&#xA;&#x9;&#x9;&#x9;workbook.setSheetHidden(workbook.getSheetIndex(&quot;Columns&quot;), true);&#xD;&#xA;&#x9;&#x9;&#x9;saveExcel();&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="init">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#x9;&#x9;titlesMap = getTitles(resultSet);&#xD;&#xA;&#x9;&#x9;setResult = removeDuplicateValues(resultSet);&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;String cadena = (String) namesFilters.get(0);&#xD;&#xA;&#x9;&#x9;Integer n = (Integer) titlesMap.get(cadena);&#xD;&#xA;&#x9;&#x9;listFixed = getArrayListFromSet((Set) setResult.get(n));&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;createListBox(listFixed, sheet, ((pgr.domain.util.impl.CoordinateImpl) posFilters.get(0)).getX(),&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;((pgr.domain.util.impl.CoordinateImpl) posFilters.get(0)).getY());&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;// Se crean las dependencias de los filtros&#xD;&#xA;&#x9;&#x9;ArrayList&lt;HashMap&lt;String, Set&lt;String>>> listDependenceMap = createDependence(resultSet, titlesMap,&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;namesFilters);&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;acc = 1;&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;// Se escribe en la sheet para utilizar los datos dentro del workbook&#xD;&#xA;&#x9;&#x9;for (int i = 0; i &lt; listDependenceMap.size(); i++) {&#xD;&#xA;&#x9;&#x9;&#x9;buildDataSheet(newDataSheet, listDependenceMap.get(i), acc);&#xD;&#xA;&#x9;&#x9;&#x9;acc += listDependenceMap.get(i).size();&#xD;&#xA;&#x9;&#x9;}"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="initDataSheet">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;//dataSheet = workbook.createSheet();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;gestionmodelosconsultas.modeloconsultas.resultset.ElementoModeloResultado element;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;for(int i=0;i&lt;result.getListResultElement().size();i++){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;element = (gestionmodelosconsultas.modeloconsultas.resultset.ElementoModeloResultado) result.getListResultElement().get(i);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;String s = getAtributtes(element);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;exploreResult(element.getListElementoModeloResultado(),s);&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;dataSheet = workbook.createSheet();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;for(int i=0;i&lt;tuplesList.size();i++){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;String s= (String) tuplesList.get(i);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;org.apache.poi.ss.usermodel.Row row = dataSheet.createRow(i);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;String tuplas[] = s.split(&quot;,&quot;);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;for(int j=0;j&lt;indexColum.size();j++){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;org.apache.poi.ss.usermodel.Cell c = row.createCell(j);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;c.setCellValue(  tuplas[ (int) indexColum.get(i) ] );&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;saveExcel();&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="indexColum" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        </eOperations>
        <eOperations name="writeFileColumns">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;try {&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;java.sql.ResultSetMetaData data = rs.getMetaData();&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;int column = data.getColumnCount();&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;for(int i=1;i&lt;=column ;i++){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;String columnName = data.getTableName(i)+&quot;.&quot;+data.getColumnName(i);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;columns.add(columnName);&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;columnSheet = workbook.getSheet(&quot;Columns&quot;);&#xD;&#xA;&#x9;&#x9;&#x9;if(columnSheet == null)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;columnSheet = workbook.createSheet(&quot;Columns&quot;);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;createTable(columns, 1, columnSheet);&#xD;&#xA;&#x9;&#x9;&#x9;saveExcel();&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;} catch (java.sql.SQLException e) {&#xD;&#xA;&#x9;&#x9;&#x9;// TODO Auto-generated catch block&#xD;&#xA;&#x9;&#x9;&#x9;e.printStackTrace();&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="rs" eType="#//datatypes/ResultSet"/>
        </eOperations>
        <eOperations name="createTable">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;org.apache.poi.xssf.usermodel.XSSFTable table =  sheet.createTable();&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;org.openxmlformats.schemas.spreadsheetml.x2006.main.CTTable cttable = table.getCTTable();&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;org.openxmlformats.schemas.spreadsheetml.x2006.main.CTTableStyleInfo table_style = cttable.addNewTableStyleInfo();&#xD;&#xA;&#x9;    table_style.setName(&quot;TableStyleMedium9&quot;); &#xD;&#xA;&#x9;    table_style.setShowColumnStripes(false); //showColumnStripes=0&#xD;&#xA;&#x9;    table_style.setShowRowStripes(true); //showRowStripes=1&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;    /* Define the data range including headers */&#xD;&#xA;&#x9;    org.apache.poi.hssf.util.AreaReference my_data_range = &#xD;&#xA;&#x9;    &#x9;&#x9;new org.apache.poi.hssf.util.AreaReference(new org.apache.poi.hssf.util.CellReference(0, 0), &#xD;&#xA;&#x9;    &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;new org.apache.poi.hssf.util.CellReference(size, columns.size()-1));&#xD;&#xA;&#x9;    &#xD;&#xA;&#x9;    /* Set Range to the Table */ &#xD;&#xA;&#x9;    cttable.setRef(my_data_range.formatAsString());&#xD;&#xA;&#x9;    cttable.setDisplayName(sheet.getSheetName());      /* this is the display name of the table */&#xD;&#xA;&#x9;    cttable.setName(sheet.getSheetName());    /* This maps to &quot;displayName&quot; attribute in &lt;table>, OOXML */            &#xD;&#xA;&#x9;    cttable.setId( (long) (workbook.getSheetIndex(sheet)+1) ); //id attribute against table as long value&#xD;&#xA;&#x9;    &#xD;&#xA;&#x9;    org.openxmlformats.schemas.spreadsheetml.x2006.main.CTTableColumns columnsTable = cttable.addNewTableColumns();&#xD;&#xA;&#x9;    columnsTable.setCount(columns.size()); //define number of columns&#xD;&#xA;&#x9;    &#xD;&#xA;&#x9;    /* Define Header Information for the Table */&#xD;&#xA;&#x9;    org.apache.poi.xssf.usermodel.XSSFRow row = sheet.createRow(0);&#xD;&#xA;&#x9;    XSSFCell cell;&#xD;&#xA;&#x9;    &#x9;    &#xD;&#xA;&#x9;    for (int i = 0; i &lt; columns.size(); i++) {&#xD;&#xA;&#x9;    &#x9;org.openxmlformats.schemas.spreadsheetml.x2006.main.CTTableColumn column = columnsTable.addNewTableColumn();   &#xD;&#xA;&#x9;    &#x9;column.setName(&quot;Column&quot;);      &#xD;&#xA;&#x9;        column.setId(i+1);&#xD;&#xA;&#x9;        cell = row.createCell(i);&#xD;&#xA;            cell.setCellValue((String)columns.get(i));&#xD;&#xA;&#x9;    }&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="columns" eType="#//datatypes/datatypesjavautil/ArrayList"/>
          <eParameters name="size" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="sheet" eType="#//datatypes/datatypeapachepoi/XSSFSheet"/>
        </eOperations>
        <eOperations name="createDataSheet">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="                                                                     try {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;workbook = readFile();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;columnSheet = workbook.getSheet(&quot;Columns&quot;);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;org.apache.poi.xssf.usermodel.XSSFRow row = columnSheet.getRow(1);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;XSSFCell cell;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;HashMap&lt;String, int[]> map = new HashMap&lt;String, int[]>();&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;for (int i = 0; i &lt;= row.getLastCellNum(); i++) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cell = row.getCell(i);&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if (cell != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;String value = getCellValue(cell);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if (value != &quot;&quot;) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;int a[] = new int[100];&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;for (int j = 0; j &lt; 100; j++)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;a[j] = -1;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if (value.contains(&quot;.&quot;)) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;String ss[] = value.split(&quot;\\.&quot;);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;String name = ss[0];&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;int order = Integer.parseInt(ss[1]);&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if (map.containsKey(name)) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;a = map.get(name);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;a[order - 1] = i;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;map.put(name, a);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;} else {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;a[order - 1] = i;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;map.put(name, a);&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;} else {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;a[0] = i;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;map.put(value, a);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;int size = 0;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;for (java.util.Map.Entry&lt;String, int[]> entry : map.entrySet()) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;String name = entry.getKey();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;columnsNames.add(name);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;size++;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;java.sql.ResultSetMetaData resultSetMetaData = resultSet.getMetaData();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;int column = resultSetMetaData.getColumnCount();&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;while (resultSet.next()) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;String string = &quot;&quot;;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;for (int i = 1; i &lt;= column; i++) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if (i == column)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;string += resultSet.getString(i);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;string += resultSet.getString(i) + &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;tuplesList.add(string);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if (namesFilters.size() == 0) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dataSheet = workbook.getSheetAt(0);&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;for (int i = 0, rowIndex = posRowIniData; i &lt; tuplesList.size(); i++, rowIndex++) {&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;String s = (String) tuplesList.get(i);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;org.apache.poi.xssf.usermodel.XSSFRow r = dataSheet.getRow(rowIndex);&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if (r == null)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;r = dataSheet.createRow(rowIndex);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;String tuplas[] = s.split(&quot;,&quot;);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;int cellIndex = posCellIniData;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;for (java.util.Map.Entry&lt;String, int[]> entry : map.entrySet()) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;int orders[] = entry.getValue();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;String concat = &quot;&quot;;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;for (int k = 0; k &lt; orders.length &amp;&amp; orders[k] != -1; k++) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;concat += tuplas[orders[k]] + &quot; &quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;org.apache.poi.xssf.usermodel.XSSFCell c = r.createCell(cellIndex);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;c.setCellValue(concat.substring(0, concat.length() - 1));&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cellIndex++;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;} else {&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;workbook.setSheetHidden(workbook.getSheetIndex(&quot;Columns&quot;), true);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if (workbook.getSheet(&quot;ResultSet&quot;) == null)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dataSheet = workbook.createSheet(&quot;ResultSet&quot;);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;workbook.removeSheetAt(workbook.getSheetIndex(&quot;ResultSet&quot;));&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dataSheet = workbook.createSheet(&quot;ResultSet&quot;);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;createTable(columnsNames, tuplesList.size(), dataSheet);&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;for (int i = 0; i &lt; tuplesList.size(); i++) {&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;String s = (String) tuplesList.get(i);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;org.apache.poi.xssf.usermodel.XSSFRow r = dataSheet.createRow(i + 1);&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;String tuplas[] = s.split(&quot;,&quot;);&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;int j = 0;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;for (java.util.Map.Entry&lt;String, int[]> entry : map.entrySet()) {&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;int orders[] = entry.getValue();&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;String concat = &quot;&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;for (int k = 0; k &lt; orders.length &amp;&amp; orders[k] != -1; k++) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;concat += tuplas[orders[k]] + &quot; &quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;org.apache.poi.xssf.usermodel.XSSFCell c = r.createCell(j);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;c.setCellValue(concat.substring(0, concat.length() - 1));&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;j++;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;workbook.setSheetHidden(workbook.getSheetIndex(&quot;Columns&quot;), true);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;workbook.setSheetHidden(workbook.getSheetIndex(&quot;Query&quot;), true);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;saveExcel();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;} catch (java.sql.SQLException e) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;// TODO Auto-generated catch block&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;e.printStackTrace();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="resultSet" eType="#//datatypes/ResultSet"/>
        </eOperations>
        <eOperations name="exploreResult">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if(elementResultList.size() == 0){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;tuplesList.add(tuple);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;return;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;gestionmodelosconsultas.modeloconsultas.resultset.ElementoModeloResultado element;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;for(int i=0;i &lt; elementResultList.size();i++){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;element = (gestionmodelosconsultas.modeloconsultas.resultset.ElementoModeloResultado) elementResultList.get(i);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;String s = getAtributtes(element);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;exploreResult(element.getListElementoModeloResultado() ,tuple+ &quot;,&quot; +s);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="elementResultList" eType="#//datatypes/EList"/>
          <eParameters name="tuple" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        </eOperations>
        <eOperations name="execute">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;// Se escriben las formulas de indirecto en el Excel&#xD;&#xA;&#x9;&#x9;setIndirect();&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;// Se escribe la formula de contar valores del resultset en el Excel&#xD;&#xA;&#x9;&#x9;countFormula(acc + 1, 0);&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;// Se escribe la formula que actualiza los datos en la tabla&#xD;&#xA;&#x9;&#x9;theFormula(posRowIniData+1, posCellIniData, acc + 1, 0, (int) titlesMap.get(listFilter.get(listFilter.size() - 1)), ((ArrayList&lt;String> )resultSet.get(0) ).size(), resultSet.size());&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="listFilter" eType="#//datatypes/datatypesjavautil/ArrayList"/>
          <eParameters name="titlesMap" eType="#//datatypes/datatypesjavautil/HashMapStringElementoConsulta"/>
          <eParameters name="acc" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="posRowIniData" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="posCellIniData" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="readFile" eType="#//datatypes/datatypeapachepoi/XSSFWorkbook">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;// Se lee el archivo&#xD;&#xA;&#x9;&#x9;try{&#xD;&#xA;&#x9;&#x9;&#x9;java.io.FileInputStream file = new java.io.FileInputStream(new java.io.File(absolutePath));&#xD;&#xA;&#x9;&#x9;&#x9;XSSFWorkbook workbook = new XSSFWorkbook(file);&#xD;&#xA;&#x9;&#x9;&#x9;return workbook;&#xD;&#xA;&#x9;&#x9;}catch (java.io.FileNotFoundException e) {&#xD;&#xA;&#x9;&#x9;&#x9;// TODO Auto-generated catch block&#xD;&#xA;&#x9;&#x9;&#x9;e.printStackTrace();&#xD;&#xA;&#x9;&#x9;} catch (java.io.IOException e) {&#xD;&#xA;&#x9;&#x9;&#x9;// TODO Auto-generated catch block&#xD;&#xA;&#x9;&#x9;&#x9;e.printStackTrace();&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;return null;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="saveExcel">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;// Se escribe el archivo con las modificaciones&#xD;&#xA;&#x9;&#x9;try{&#xD;&#xA;&#x9;&#x9;&#x9;java.io.FileOutputStream fileOutputStream;&#xD;&#xA;&#x9;&#x9;&#x9;fileOutputStream = new java.io.FileOutputStream(absolutePath);&#xD;&#xA;&#x9;&#x9;&#x9;workbook.write(fileOutputStream);&#xD;&#xA;&#x9;&#x9;&#x9;fileOutputStream.close();&#xD;&#xA;&#x9;&#x9;}catch (java.io.FileNotFoundException e) {&#xD;&#xA;&#x9;&#x9;&#x9;// TODO Auto-generated catch block&#xD;&#xA;&#x9;&#x9;&#x9;e.printStackTrace();&#xD;&#xA;&#x9;&#x9;} catch (java.io.IOException e) {&#xD;&#xA;&#x9;&#x9;&#x9;// TODO Auto-generated catch block&#xD;&#xA;&#x9;&#x9;&#x9;e.printStackTrace();&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="createNames">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;// Se borran los nombres del workbook para actualizarlos&#xD;&#xA;&#x9;&#x9;deleteNames(workbook);&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;// Se crean los nombres en el workbook de las columnas del result set&#xD;&#xA;&#x9;&#x9;nameTableToNameRange(dataSheet, (ArrayList&lt;String>)resultSet.get(0));&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="readSheet">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;// Se obtienen las sheet necesarias para el proceso&#xD;&#xA;&#x9;&#x9;if (workbook.getSheet(&quot;Datos&quot;) == null) {&#xD;&#xA;&#x9;&#x9;&#x9;newDataSheet = workbook.createSheet(&quot;Datos&quot;);&#xD;&#xA;&#x9;&#x9;} else {&#xD;&#xA;&#x9;&#x9;&#x9;workbook.removeSheetAt(workbook.getSheetIndex(&quot;Datos&quot;));&#xD;&#xA;&#x9;&#x9;&#x9;newDataSheet = workbook.createSheet(&quot;Datos&quot;);&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;int numSheet = workbook.getNumberOfSheets();&#xD;&#xA;&#x9;&#x9;dataSheet = workbook.getSheetAt(numSheet - 2);&#xD;&#xA;&#x9;&#x9;sheet = workbook.getSheetAt(0);&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="getNumToCol" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;return org.apache.poi.hssf.util.CellReference.convertNumToColString(col);&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="col" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="getResulSet" eType="#//datatypes/datatypesjavautil/ArrayList">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;ArrayList&lt;ArrayList&lt;String>> resultSet = new ArrayList&lt;>();&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;java.util.Iterator&lt;org.apache.poi.ss.usermodel.Row> rowIterator = sheet.iterator();&#xD;&#xA;&#x9;&#x9;org.apache.poi.ss.usermodel.Row row;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;while (rowIterator.hasNext()) {&#xD;&#xA;&#x9;&#x9;&#x9;row = rowIterator.next();&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;java.util.Iterator&lt;org.apache.poi.ss.usermodel.Cell> cellIterator = row.cellIterator();&#xD;&#xA;&#x9;&#x9;&#x9;org.apache.poi.ss.usermodel.Cell celda;&#xD;&#xA;&#x9;&#x9;&#x9;ArrayList&lt;String> tupla = new ArrayList&lt;>();&#xD;&#xA;&#x9;&#x9;&#x9;while (cellIterator.hasNext()) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;celda = cellIterator.next();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;celda.setCellType(org.apache.poi.ss.usermodel.Cell.CELL_TYPE_STRING);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;tupla.add(celda.getStringCellValue());&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;resultSet.add(tupla);&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;return resultSet;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="sheet" eType="#//datatypes/datatypeapachepoi/XSSFSheet"/>
        </eOperations>
        <eOperations name="getSetColum" eType="#//datatypes/datatypesjavautil/Set">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;Set&lt;String> setColumn = new java.util.HashSet&lt;>();&#xD;&#xA;&#x9;&#x9;for (int i = 1; i &lt; resultSet.size(); i++) {&#xD;&#xA;&#x9;&#x9;&#x9;setColumn.add( ( (ArrayList&lt;String> )resultSet.get(i) ).get(column));&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;return setColumn;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="resultSet" eType="#//datatypes/datatypesjavautil/ArrayList"/>
          <eParameters name="column" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="getMapOfColumnByColumn" eType="#//datatypes/datatypesjavautil/HashMapStringElementoConsulta">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;HashMap&lt;String, Set&lt;String>> mapColumn = new HashMap&lt;>();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;for (int i = 1; i &lt; resultSet.size(); i++) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;String key = ((ArrayList&lt;String>) resultSet.get(i)).get(columnSource);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;String value = ((ArrayList&lt;String>) resultSet.get(i)).get(columnTarget);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if (mapColumn.get(key) == null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Set&lt;String> name = new java.util.HashSet&lt;>();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;name.add(value);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;mapColumn.put(key, name);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;} else {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;mapColumn.get(key).add(value);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;return mapColumn;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="resultSet" eType="#//datatypes/datatypesjavautil/ArrayList"/>
          <eParameters name="columnSource" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="columnTarget" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="createListBox">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="org.apache.poi.xssf.usermodel.XSSFWorkbook workbook = (XSSFWorkbook) sheet.getWorkbook();&#xD;&#xA;&#x9;&#x9;org.apache.poi.ss.usermodel.Name name = null;&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;name = workbook.createName();&#xD;&#xA;&#x9;&#x9;String replaceAll = ((String) namesFilters.get(0) + &quot;s&quot;).replaceAll(&quot; &quot;, &quot;_&quot;);&#xD;&#xA;&#x9;&#x9;name.setNameName(replaceAll);&#xD;&#xA;&#x9;&#x9;String colIni = getNumToCol(0);&#xD;&#xA;&#x9;&#x9;XSSFSheet sheet2 = workbook.getSheet(&quot;Datos&quot;);&#xD;&#xA;&#x9;&#x9;org.apache.poi.ss.usermodel.Row rowS = sheet2.createRow(0);&#xD;&#xA;&#x9;&#x9;int k = 0;&#xD;&#xA;&#x9;&#x9;for (; k &lt; comboNames.size(); k++) {&#xD;&#xA;&#x9;&#x9;&#x9;org.apache.poi.ss.usermodel.Cell cellS = rowS.createCell(k);&#xD;&#xA;&#x9;&#x9;&#x9;cellS.setCellValue((String)comboNames.get(k));&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;String colFin = getNumToCol(k - 1);&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;name.setRefersToFormula(&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;sheet2.getSheetName() + &quot;!$&quot; + colIni + &quot;$&quot; + 1 + &quot;:$&quot; + colFin + &quot;$&quot; + 1);&#xD;&#xA;&#x9;&#x9;System.out.println(&#x9;sheet2.getSheetName() + &quot;!$&quot; + colIni + &quot;$&quot; + 1 + &quot;:$&quot; + colFin + &quot;$&quot; + 1);&#xD;&#xA;&#x9;&#x9;org.apache.poi.ss.usermodel.DataValidationHelper helper = sheet.getDataValidationHelper();&#xD;&#xA;&#x9;&#x9;org.apache.poi.ss.usermodel.DataValidationConstraint constraint = null;&#xD;&#xA;&#x9;&#x9;org.apache.poi.ss.usermodel.DataValidation validation = null;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;constraint = helper.createFormulaListConstraint(replaceAll);&#xD;&#xA;&#x9;&#x9;System.out.println(&quot;&quot;+(String) namesFilters.get(0)+&quot;s&quot;);&#xD;&#xA;&#x9;&#x9;validation = helper.createValidation(constraint,&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;new org.apache.poi.ss.util.CellRangeAddressList(&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;((pgr.domain.util.impl.CoordinateImpl) posFilters.get(0)).getX(),&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;((pgr.domain.util.impl.CoordinateImpl) posFilters.get(0)).getX(),&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;((pgr.domain.util.impl.CoordinateImpl) posFilters.get(0)).getY(),&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;((pgr.domain.util.impl.CoordinateImpl) posFilters.get(0)).getY()));&#xD;&#xA;&#x9;&#x9;sheet.addValidationData(validation);&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="comboNames" eType="#//datatypes/datatypesjavautil/ArrayList"/>
          <eParameters name="sheet" eType="#//datatypes/datatypeapachepoi/XSSFSheet"/>
          <eParameters name="row" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="col" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="buildDataSheet">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;org.apache.poi.xssf.usermodel.XSSFRow row = null;&#xD;&#xA;&#x9;&#x9;XSSFCell cell = null;&#xD;&#xA;&#x9;&#x9;org.apache.poi.ss.usermodel.Name name = null;&#xD;&#xA;&#x9;&#x9;int i = rowN;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;HashMap&lt;String, Set&lt;String>> map = mp;&#xD;&#xA;&#x9;&#x9;java.util.Iterator&lt;String> it = map.keySet().iterator();&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;while (it.hasNext()) {&#xD;&#xA;&#x9;&#x9;&#x9;int j = 0; &#xD;&#xA;&#x9;&#x9;&#x9;String key = (String) it.next();&#xD;&#xA;&#x9;&#x9;&#x9;row = sheet.createRow(i);&#xD;&#xA;&#x9;&#x9;&#x9;for (String value : map.get(key)) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;cell = row.createCell(j);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;cell.setCellValue(value);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;j++;&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;name = sheet.getWorkbook().createName();&#xD;&#xA;&#x9;&#x9;&#x9;name.setNameName(key.replaceAll(&quot; &quot;, &quot;_&quot;));&#xD;&#xA;&#x9;&#x9;&#x9;String colIni = getNumToCol(0);&#xD;&#xA;&#x9;&#x9;&#x9;String colFin = getNumToCol(j - 1);&#xD;&#xA;&#x9;&#x9;&#x9;name.setRefersToFormula(&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;sheet.getSheetName() + &quot;!$&quot; + colIni + &quot;$&quot; + (i + 1) + &quot;:$&quot; + colFin + &quot;$&quot; + (i + 1));&#xD;&#xA;&#x9;&#x9;&#x9;i++;&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="sheet" eType="#//datatypes/datatypeapachepoi/XSSFSheet"/>
          <eParameters name="mp" eType="#//datatypes/datatypesjavautil/HashMapStringElementoConsulta"/>
          <eParameters name="rowN" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="setIndirect">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;org.apache.poi.ss.usermodel.DataValidationHelper helper = sheet.getDataValidationHelper();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;org.apache.poi.ss.usermodel.DataValidationConstraint constraint = null;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;org.apache.poi.ss.usermodel.DataValidation validation = null;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;for (int i = 1; i &lt; posFilters.size(); i++) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;String cell = getNumToCol(  ((pgr.domain.util.impl.CoordinateImpl)posFilters.get(i-1)).getY());&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;constraint = helper.createFormulaListConstraint(&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&quot;INDIRECT(SUBSTITUTE(&quot; + sheet.getSheetName() + &quot;!$&quot; + cell + &quot;$&quot; +   ( ((pgr.domain.util.impl.CoordinateImpl)posFilters.get(i-1)).getX() + 1) + &quot;,\&quot; \&quot;, \&quot;_\&quot;))&quot;);&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;validation = helper.createValidation(constraint, new org.apache.poi.ss.util.CellRangeAddressList(  ((pgr.domain.util.impl.CoordinateImpl) posFilters.get(i)).getX(),&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;((pgr.domain.util.impl.CoordinateImpl)posFilters.get(i)).getX(),((pgr.domain.util.impl.CoordinateImpl) posFilters.get(i)).getY(), ((pgr.domain.util.impl.CoordinateImpl) posFilters.get(i)).getY()));&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;sheet.addValidationData(validation);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="deleteNames">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;int n = workbook.getNumberOfNames();&#xD;&#xA;&#x9;&#x9;while (n != 0) {&#xD;&#xA;&#x9;&#x9;&#x9;String del = workbook.getNameAt(0).getNameName();&#xD;&#xA;&#x9;&#x9;&#x9;workbook.removeName(del);&#xD;&#xA;&#x9;&#x9;&#x9;n--;&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="workbook" eType="#//datatypes/datatypeapachepoi/XSSFWorkbook"/>
        </eOperations>
        <eOperations name="nameTableToNameRange">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;XSSFWorkbook workbook = (XSSFWorkbook) sheet.getWorkbook();&#xD;&#xA;&#x9;&#x9;org.apache.poi.ss.usermodel.Name name = null;&#xD;&#xA;&#x9;&#x9;for (int i = 0; i &lt; names.size(); i++) {&#xD;&#xA;&#x9;&#x9;&#x9;name = workbook.createName();&#xD;&#xA;&#x9;&#x9;&#x9;name.setNameName( ( (String) names.get(i)).replaceAll(&quot; &quot;, &quot;_&quot;));&#xD;&#xA;&#x9;&#x9;&#x9;name.setRefersToFormula(&quot;ResultSet[&quot; + names.get(i) + &quot;]&quot;);&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="sheet" eType="#//datatypes/datatypeapachepoi/XSSFSheet"/>
          <eParameters name="names" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        </eOperations>
        <eOperations name="countFormula">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;org.apache.poi.xssf.usermodel.XSSFRow row = newDataSheet.createRow(targetRow);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;XSSFCell cell = row.createCell(targetCell);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;String formula = &quot;COUNTIFS(ResultSet[&quot;+namesFilters.get(0)+&quot;],&quot;+sheet.getSheetName()+&quot;!&quot;+getNumToCol(  ((pgr.domain.util.impl.CoordinateImpl)posFilters.get(0)).getY())+(  ((pgr.domain.util.impl.CoordinateImpl)posFilters.get(0)).getX()+1);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;for(int i = 1; i &lt; namesFilters.size();i++){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;formula+=&quot;,ResultSet[&quot;+namesFilters.get(i)+&quot;],&quot;+sheet.getSheetName()+&quot;!&quot;+getNumToCol( ((pgr.domain.util.impl.CoordinateImpl)posFilters.get(i)).getY())+(((pgr.domain.util.impl.CoordinateImpl)posFilters.get(i)).getX()+1);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;formula+=&quot;)&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;cell.setCellFormula(formula);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="targetRow" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="targetCell" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="theFormula">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;String sheet1 = sheet.getSheetName();&#xD;&#xA;&#x9;&#x9;&#x9;String sheet2 = dataSheet.getSheetName();&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;for (int i = 0; i &lt; sizeY; i++) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;for (int j = 0; j &lt; sizeX; j++) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;String filas = &quot;ROWS(&quot; + sheet1 + &quot;!&quot; + getNumToCol(targetCell + j) + &quot;$&quot; + targetRow + &quot;:&quot; + sheet1 + &quot;!&quot;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+ getNumToCol(targetCell + j) + (targetRow + i) + &quot;)&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;int n = namesFilters.size();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;String constraint =&quot;((&quot;+ ((String)namesFilters.get(n-1)).replaceAll(&quot; &quot;, &quot;_&quot;)+&quot;=$&quot;+getNumToCol( ((pgr.domain.util.impl.CoordinateImpl)posFilters.get(n-1)).getY())+&quot;$&quot;+(((pgr.domain.util.impl.CoordinateImpl)posFilters.get(n-1)).getX()+1)+&quot;)&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;for (int k = n-2; k >= 0; k--) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;constraint += &quot;*(&quot;+ ((String)namesFilters.get(k)).replaceAll(&quot; &quot;, &quot;_&quot;) + &quot;=$&quot; + getNumToCol( ((pgr.domain.util.impl.CoordinateImpl)posFilters.get(k)).getY()) + &quot;$&quot; + ( ((pgr.domain.util.impl.CoordinateImpl)posFilters.get(k)).getX()+1)+&quot;)&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;constraint+=&quot;)&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;String si = &quot;IF(&quot; + constraint + &quot;,ROW(&quot; + ( (String)namesFilters.get(namesFilters.size()-1) ) .replaceAll(&quot; &quot;, &quot;_&quot;)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+ &quot;)-ROW(&quot; + sheet2 + &quot;!$&quot; + getNumToCol(firstCellFilter) + &quot;$&quot; + firstRowFilter + &quot;)+1)&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;String formula = &quot;IF(&quot; + filas + &quot;&lt;=&quot; + newDataSheet.getSheetName() + &quot;!$&quot; + getNumToCol(countCell) + &quot;$&quot;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+ (countRow + 1) + &quot;,INDEX(INDIRECT(SUBSTITUTE(&quot; + getNumToCol(targetCell + j) + &quot;$&quot; + (targetRow - 1)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+ &quot;,\&quot; \&quot;,\&quot;_\&quot;)),SMALL(&quot; + si + &quot;,&quot; + filas + &quot;)),\&quot;\&quot;)&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;sheet.setArrayFormula(formula,&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;new org.apache.poi.ss.util.CellRangeAddress((targetRow + i) - 1, (targetRow + i) - 1, targetCell + j, targetCell + j));&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#xD;&#xA;&#x9;&#xD;&#xA;"/>
          </eAnnotations>
          <eParameters name="targetRow" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="targetCell" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="countRow" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="countCell" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="firstCellFilter" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EIntegerObject"/>
          <eParameters name="sizeX" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="sizeY" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="createDependence" eType="#//datatypes/datatypesjavautil/ArrayList">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;ArrayList&lt; HashMap&lt;String, Set&lt;String>>> listDependenceMap = new ArrayList&lt;>();&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;for (int i = 1; i &lt; listFilter.size(); i++)&#xD;&#xA;&#x9;&#x9;&#x9;listDependenceMap.add(getMapOfColumnByColumn(resultSet,(int) titlesMap.get(listFilter.get((i - 1))),&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;(int)titlesMap.get(listFilter.get(i))));&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;return listDependenceMap;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="resultSet" eType="#//datatypes/datatypesjavautil/ArrayList"/>
          <eParameters name="titlesMap" eType="#//datatypes/datatypesjavautil/HashMapStringElementoConsulta"/>
          <eParameters name="listFilter" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        </eOperations>
        <eOperations name="getTitles" eType="#//datatypes/datatypesjavautil/HashMapStringElementoConsulta">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;HashMap&lt;String, Integer> titlesMap = new HashMap&lt;>();&#xD;&#xA;&#x9;&#x9;ArrayList&lt;ArrayList&lt;String>> result = resultSet;&#xD;&#xA;&#x9;&#x9;for (int i = 0; i &lt; result.get(0).size(); i++) {&#xD;&#xA;&#x9;&#x9;&#x9;String key = result.get(0).get(i);&#xD;&#xA;&#x9;&#x9;&#x9;titlesMap.put(key, new Integer(i));&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;return titlesMap;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="resultSet" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        </eOperations>
        <eOperations name="removeDuplicateValues" eType="#//datatypes/datatypesjavautil/ArrayList">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;ArrayList&lt;Set&lt;String>> setResult = new ArrayList&lt;>();&#xD;&#xA;&#x9;&#x9;for (int i = 0; i &lt;((ArrayList&lt;String>) resultSet.get(0)).size(); i++)&#xD;&#xA;&#x9;&#x9;&#x9;setResult.add(getSetColum(resultSet, i));&#xD;&#xA;&#x9;&#x9;return setResult;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="resultSet" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        </eOperations>
        <eOperations name="getAtributtes" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="String answer = &quot;&quot;;&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;if (element instanceof gestionmodelosconsultas.modeloconsultas.resultset.resultquien.UnidadOrganizacional) {&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;gestionmodelosconsultas.modeloconsultas.resultset.resultquien.UnidadOrganizacional unidadOrganizacional = (gestionmodelosconsultas.modeloconsultas.resultset.resultquien.UnidadOrganizacional) element;&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;if (unidadOrganizacional.getIdUnidadOrganizacional() != null)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += unidadOrganizacional.getIdUnidadOrganizacional();&#xD;&#xA;&#x9;&#x9;&#x9;if (unidadOrganizacional.getNombre() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += unidadOrganizacional.getNombre();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;if (unidadOrganizacional.getDescripcion() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += unidadOrganizacional.getDescripcion();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;} else if (element instanceof gestionmodelosconsultas.modeloconsultas.resultset.resultquien.Actor) {&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;gestionmodelosconsultas.modeloconsultas.resultset.resultquien.Actor actor = (gestionmodelosconsultas.modeloconsultas.resultset.resultquien.Actor) element;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;if (actor.getIdActor() != null)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += actor.getIdActor();&#xD;&#xA;&#x9;&#x9;&#x9;if (actor.getNombre() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += actor.getNombre();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;if (actor.getApellido() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += actor.getApellido();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;if (actor.getEmail() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += actor.getEmail();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;if (actor.getDescripcion() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += actor.getDescripcion();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;} else if (element instanceof gestionmodelosconsultas.modeloconsultas.resultset.resultquien.Rol) {&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;gestionmodelosconsultas.modeloconsultas.resultset.resultquien.Rol rol = (gestionmodelosconsultas.modeloconsultas.resultset.resultquien.Rol) element;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;if (rol.getIdRol() != null)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += rol.getIdRol();&#xD;&#xA;&#x9;&#x9;&#x9;if (rol.getNombre() != null)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += rol.getNombre();&#xD;&#xA;&#x9;&#x9;&#x9;if (rol.getDescripcion() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += rol.getDescripcion();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;} else if (element instanceof gestionmodelosconsultas.modeloconsultas.resultset.resultquien.Contacto) {&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;gestionmodelosconsultas.modeloconsultas.resultset.resultquien.Contacto contacto = (gestionmodelosconsultas.modeloconsultas.resultset.resultquien.Contacto) element;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;if (contacto.getIdContacto() != null)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += contacto.getIdContacto();&#xD;&#xA;&#x9;&#x9;&#x9;if (contacto.getNombre() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += contacto.getNombre();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;if (contacto.getUsername() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += contacto.getUsername();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;if (contacto.getTelefono() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += contacto.getTelefono();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;if (contacto.getPassword() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += contacto.getPassword();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;if (contacto.getDescripcion() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += contacto.getDescripcion();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;} else if (element instanceof gestionmodelosconsultas.modeloconsultas.resultset.resultque.Documento) {&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;gestionmodelosconsultas.modeloconsultas.resultset.resultque.Documento documento = (gestionmodelosconsultas.modeloconsultas.resultset.resultque.Documento) element;&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;if (documento.getIdDocumento() != null)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += documento.getIdDocumento();&#xD;&#xA;&#x9;&#x9;&#x9;if (documento.getTitulo() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += documento.getTitulo();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;if (documento.getTipo() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += documento.getTipo();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;if (documento.getFechaCreacion() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += documento.getFechaCreacion();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;if (documento.getEstado() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += documento.getEstado();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;if (documento.getComentarios() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += documento.getComentarios();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;if (documento.getEdicion() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += documento.getEdicion();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;if (documento.getAnexo() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += documento.getAnexo();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;if (documento.getVigencia() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += documento.getVigencia();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;} else if (element instanceof gestionmodelosconsultas.modeloconsultas.resultset.resultque.Comunicacion) {&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;gestionmodelosconsultas.modeloconsultas.resultset.resultque.Comunicacion comunicacion = (gestionmodelosconsultas.modeloconsultas.resultset.resultque.Comunicacion) element;&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;if (comunicacion.getIdComunicacion() != null)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += comunicacion.getIdComunicacion();&#xD;&#xA;&#x9;&#x9;&#x9;if (comunicacion.getAsunto() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += comunicacion.getAsunto();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;} else if (element instanceof gestionmodelosconsultas.modeloconsultas.resultset.resultcomo.ActividadProceso) {&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;gestionmodelosconsultas.modeloconsultas.resultset.resultcomo.ActividadProceso actividadProceso = (gestionmodelosconsultas.modeloconsultas.resultset.resultcomo.ActividadProceso) element;&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;if (actividadProceso.getIdActividadProceso() != null)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += actividadProceso.getIdActividadProceso();&#xD;&#xA;&#x9;&#x9;&#x9;if (actividadProceso.getNombre() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += actividadProceso.getNombre();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;if (actividadProceso.getDescripcion() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += actividadProceso.getDescripcion();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;if (actividadProceso.getFechaInicio() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += actividadProceso.getFechaInicio();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;if (actividadProceso.getFechaFin() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += actividadProceso.getFechaFin();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;} else if (element instanceof gestionmodelosconsultas.modeloconsultas.resultset.resultcomo.InstanciaProceso) {&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;gestionmodelosconsultas.modeloconsultas.resultset.resultcomo.InstanciaProceso instanciaProceso = (gestionmodelosconsultas.modeloconsultas.resultset.resultcomo.InstanciaProceso) element;&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;if (instanciaProceso.getIdInstanciaProceso() != null)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += instanciaProceso.getIdInstanciaProceso();&#xD;&#xA;&#x9;&#x9;&#x9;if (instanciaProceso.getNombre() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += instanciaProceso.getNombre();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;if (instanciaProceso.getDescripcion() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += instanciaProceso.getDescripcion();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;} else if (element instanceof gestionmodelosconsultas.modeloconsultas.resultset.resultdonde.Deposito) {&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;gestionmodelosconsultas.modeloconsultas.resultset.resultdonde.Deposito deposito = (gestionmodelosconsultas.modeloconsultas.resultset.resultdonde.Deposito) element;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;if (deposito.getIdDeposito() != null)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += deposito.getIdDeposito();&#xD;&#xA;&#x9;&#x9;&#x9;if (deposito.getDescripcion() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += deposito.getDescripcion();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;} else if (element instanceof gestionmodelosconsultas.modeloconsultas.resultset.resultdonde.Disco) {&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;gestionmodelosconsultas.modeloconsultas.resultset.resultdonde.Disco disco = (gestionmodelosconsultas.modeloconsultas.resultset.resultdonde.Disco) element;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;if (disco.getIdDisco() != null)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += disco.getIdDisco();&#xD;&#xA;&#x9;&#x9;&#x9;if (disco.getReferencia() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += disco.getReferencia();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;if (disco.getDescripcion() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += disco.getDescripcion();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;} else if (element instanceof gestionmodelosconsultas.modeloconsultas.resultset.resultdonde.Armario) {&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;gestionmodelosconsultas.modeloconsultas.resultset.resultdonde.Armario armario = (gestionmodelosconsultas.modeloconsultas.resultset.resultdonde.Armario) element;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;if (armario.getIdArmario() != null)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += armario.getIdArmario();&#xD;&#xA;&#x9;&#x9;&#x9;if (armario.getDescripcion() != null) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (answer.length() > 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;answer += &quot;,&quot;;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;answer += armario.getDescripcion();&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;return answer;"/>
          </eAnnotations>
          <eParameters name="element" eType="#//datatypes/datatypesqm/ResultElement"/>
        </eOperations>
        <eOperations name="createSheetQuery">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;XSSFSheet query = workbook.createSheet(&quot;Query&quot;);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;org.apache.poi.xssf.usermodel.XSSFRow row = query.createRow(0);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;XSSFCell cell = row.createCell(0);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;cell.setCellValue(queryString);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;int i =1;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;for(;i&lt;= namesFilters.size();i++){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;row = query.createRow(i);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;cell = row.createCell(0);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;cell.setCellValue(&quot;&quot;+  ((pgr.domain.util.impl.CoordinateImpl)posFilters.get(i-1)).getX());&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;cell = row.createCell(1);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;cell.setCellValue(&quot;&quot;+ ((pgr.domain.util.impl.CoordinateImpl)posFilters.get(i-1)).getY());&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;cell = row.createCell(2);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;cell.setCellValue(&quot;&quot;+ namesFilters.get(i-1));&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;row = query.createRow(i);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;cell = row.createCell(0);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;cell.setCellValue(&quot;&quot;+ posRowIniData);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;cell = row.createCell(1);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;cell.setCellValue(&quot;&quot;+ posCellIniData);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;workbook.setSheetHidden(workbook.getSheetIndex(&quot;Query&quot;), XSSFWorkbook.SHEET_STATE_HIDDEN);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="removeSheets">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;workbook.removeSheetAt(workbook.getSheetIndex(&quot;Query&quot;));&#xD;&#xA;&#x9;&#x9;workbook.removeSheetAt(workbook.getSheetIndex(&quot;Columns&quot;));&#xD;&#xA;&#x9;&#x9;saveExcel();&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="copyExcel">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;try {&#xD;&#xA;&#x9;&#x9;&#x9;java.io.File sourceFile = new java.io.File(sourcePath);&#xD;&#xA;&#x9;&#x9;&#x9;java.io.File targetDir  = new java.io.File(targetPath);&#xD;&#xA;&#x9;&#x9;&#x9;org.apache.commons.io.FileUtils.copyFileToDirectory(sourceFile, targetDir);&#xD;&#xA;&#x9;&#x9;} catch (java.io.IOException e) {&#xD;&#xA;&#x9;&#x9;&#x9;// TODO Auto-generated catch block&#xD;&#xA;&#x9;&#x9;&#x9;e.printStackTrace();&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="sourcePath" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
          <eParameters name="targetPath" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        </eOperations>
        <eOperations name="openFileIntoEditor">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;java.io.File fileToOpen = new java.io.File(path);&#xD;&#xA;&#x9;&#x9; &#xD;&#xA;&#x9;&#x9;if (fileToOpen.exists() &amp;&amp; fileToOpen.isFile()) {&#xD;&#xA;&#x9;&#x9;&#x9;org.eclipse.core.filesystem.IFileStore fileStore = org.eclipse.core.filesystem.EFS.getLocalFileSystem().getStore(fileToOpen.toURI());&#xD;&#xA;&#x9;&#x9;&#x9;org.eclipse.ui.IWorkbenchPage page = org.eclipse.ui.PlatformUI.getWorkbench().getActiveWorkbenchWindow().getActivePage();&#xD;&#xA;&#x9;&#x9; &#xD;&#xA;&#x9;&#x9;    try {&#xD;&#xA;&#x9;&#x9;    &#x9;org.eclipse.ui.ide.IDE.openEditorOnFileStore( page, fileStore);&#xD;&#xA;&#x9;&#x9;    } catch ( org.eclipse.ui.PartInitException e ) {&#xD;&#xA;&#x9;&#x9;        //Put your exception handler here if you wish to&#xD;&#xA;&#x9;&#x9;    }&#xD;&#xA;&#x9;&#x9;} else {&#xD;&#xA;&#x9;&#x9;    //Do something if the file does not exist&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="path" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        </eOperations>
        <eOperations name="getDir" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;int index = absolutePath.length()-1;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;char c = absolutePath.charAt(index);&#xD;&#xA;&#x9;&#x9;while(c!='/'){&#xD;&#xA;&#x9;&#x9;&#x9;index--;&#xD;&#xA;&#x9;&#x9;&#x9;c = absolutePath.charAt(index);&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;return absolutePath.substring(0, index);&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="absolutePath" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        </eOperations>
        <eOperations name="getCellValue" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9; int cel_Type = cell.getCellType();                           &#xD;&#xA;&#x9;     String res=&quot;&quot;;&#xD;&#xA;&#x9;&#x9; switch(cel_Type){&#xD;&#xA;&#x9;     &#x9;case 0: res+=cell.getNumericCellValue();&#xD;&#xA;&#x9;             &#x9;break;&#xD;&#xA;&#x9;     &#x9;case 1: res+=cell.getStringCellValue();&#xD;&#xA;&#x9;     &#x9;&#x9;&#x9;break;&#xD;&#xA;&#x9;     &#x9;case 4:res+=cell.getBooleanCellValue();&#xD;&#xA;&#x9;             &#x9;break;&#xD;&#xA;&#x9;     &#x9;case 3:res+=&quot;&quot;;&#xD;&#xA;&#x9;     &#x9;&#x9;&#x9;break; &#xD;&#xA;&#x9;     }&#xD;&#xA;&#x9;&#x9; return res;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="cell" eType="#//datatypes/datatypeapachepoi/XSSFCell"/>
        </eOperations>
        <eOperations name="getArrayListFromSet" eType="#//datatypes/datatypesjavautil/ArrayList">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;ArrayList&lt;String> names=new ArrayList&lt;String>();&#xD;&#xA;&#x9;&#x9;names.addAll(s);&#xD;&#xA;&#x9;&#x9;return names;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="s" eType="#//datatypes/datatypesjavautil/Set"/>
        </eOperations>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="absolutePath" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="workbook" eType="#//datatypes/datatypeapachepoi/XSSFWorkbook"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="newDataSheet" eType="#//datatypes/datatypeapachepoi/XSSFSheet"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="dataSheet" eType="#//datatypes/datatypeapachepoi/XSSFSheet"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="columnSheet" eType="#//datatypes/datatypeapachepoi/XSSFSheet"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="sheet" eType="#//datatypes/datatypeapachepoi/XSSFSheet"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="queryString" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="modelFactoryQM" eType="#//datatypes/datatypesqm/ModelFactory"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="resultSet" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="namesFilters" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="posFilters" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="titlesMap" eType="#//datatypes/datatypesjavautil/HashMapStringElementoConsulta"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="setResult" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="listFixed" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="result" eType="#//datatypes/datatypesqm/Resultado"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="tuplesList" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="columns" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="columnsNames" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="columnsIndex" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="acc" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="firstRowFilter" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="posRowIniData" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="posCellIniData" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        <eStructuralFeatures xsi:type="ecore:EReference" name="theDomain" eType="#//domain/Domain"
            transient="true" eOpposite="#//domain/Domain/theExcelGenerator"/>
      </eClassifiers>
      <eClassifiers xsi:type="ecore:EClass" name="ExcelUpdater">
        <eOperations name="ExcelUpdater">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;this.filePath = filePath;&#xD;&#xA;&#x9;&#x9;try {&#xD;&#xA;&#x9;&#x9;&#x9;dc = DataConnection.getInstance();&#xD;&#xA;&#x9;&#x9;&#x9;workbook = readFile();&#xD;&#xA;&#x9;&#x9;} catch (java.lang.ClassNotFoundException | java.sql.SQLException e) {&#xD;&#xA;&#x9;&#x9;&#x9;// TODO Auto-generated catch block&#xD;&#xA;&#x9;&#x9;&#x9;e.printStackTrace();&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="filePath" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        </eOperations>
        <eOperations name="readFile" eType="#//datatypes/datatypeapachepoi/XSSFWorkbook">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;// Se lee el archivo&#xD;&#xA;&#x9;&#x9;try{&#xD;&#xA;&#x9;&#x9;&#x9;java.io.FileInputStream file = new java.io.FileInputStream(new java.io.File(filePath));&#xD;&#xA;&#x9;&#x9;&#x9;XSSFWorkbook workbook = new XSSFWorkbook(file);&#xD;&#xA;&#x9;&#x9;&#x9;return workbook;&#xD;&#xA;&#x9;&#x9;}catch (java.io.FileNotFoundException e) {&#xD;&#xA;&#x9;&#x9;&#x9;// TODO Auto-generated catch block&#xD;&#xA;&#x9;&#x9;&#x9;e.printStackTrace();&#xD;&#xA;&#x9;&#x9;} catch (java.io.IOException e) {&#xD;&#xA;&#x9;&#x9;&#x9;// TODO Auto-generated catch block&#xD;&#xA;&#x9;&#x9;&#x9;e.printStackTrace();&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;return null;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="saveExcel">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;// Se escribe el archivo con las modificaciones&#xD;&#xA;&#x9;&#x9;try{&#xD;&#xA;&#x9;&#x9;&#x9;java.io.FileOutputStream fileOutputStream;&#xD;&#xA;&#x9;&#x9;&#x9;fileOutputStream = new java.io.FileOutputStream(filePath);&#xD;&#xA;&#x9;&#x9;&#x9;workbook.write(fileOutputStream);&#xD;&#xA;&#x9;&#x9;&#x9;fileOutputStream.close();&#xD;&#xA;&#x9;&#x9;}catch (java.io.FileNotFoundException e) {&#xD;&#xA;&#x9;&#x9;&#x9;// TODO Auto-generated catch block&#xD;&#xA;&#x9;&#x9;&#x9;e.printStackTrace();&#xD;&#xA;&#x9;&#x9;} catch (java.io.IOException e) {&#xD;&#xA;&#x9;&#x9;&#x9;// TODO Auto-generated catch block&#xD;&#xA;&#x9;&#x9;&#x9;e.printStackTrace();&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="executeQuery">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;try{&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;com.mysql.jdbc.Connection connection = dc.getConnection();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;com.mysql.jdbc.PreparedStatement ps = (com.mysql.jdbc.PreparedStatement)connection.prepareStatement(stringQuery);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;java.sql.ResultSet rs = ps.executeQuery();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pgr.domain.generators.ExcelGenerator excelGenerator = pgr.domain.generators.GeneratorsFactory.eINSTANCE.createExcelGenerator();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;excelGenerator.ExcelGenerator(filePath,listFilter,posFilter);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;excelGenerator.createDataSheet(rs);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if(excelGenerator.getNamesFilters().size() != 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;excelGenerator.createRelations();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}catch (java.sql.SQLException e){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;e.printStackTrace();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="readSheetQuery">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;// Se obtienen las sheet necesarias para el proceso&#xD;&#xA;&#x9;&#x9;org.apache.poi.xssf.usermodel.XSSFSheet sheet = workbook.getSheet(&quot;Query&quot;);&#xD;&#xA;&#x9;&#x9;if (sheet != null) {&#xD;&#xA;&#x9;&#x9;&#x9;org.apache.poi.xssf.usermodel.XSSFRow row = sheet.getRow(0);&#xD;&#xA;&#x9;&#x9;&#x9;org.apache.poi.xssf.usermodel.XSSFCell cell = row.getCell(0);&#xD;&#xA;&#x9;&#x9;&#x9;stringQuery = cell.getStringCellValue();&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;posFilter = new ArrayList&lt; pgr.domain.util.impl.CoordinateImpl>();&#xD;&#xA;&#x9;&#x9;listFilter = new ArrayList&lt;String>();&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;org.apache.poi.xssf.usermodel.XSSFCell c;&#xD;&#xA;&#x9;&#x9;org.apache.poi.xssf.usermodel.XSSFRow r;&#xD;&#xA;&#x9;&#x9;String x,y,name;&#xD;&#xA;&#x9;&#x9;for(int i=1;i&lt;sheet.getLastRowNum();i++){&#xD;&#xA;&#x9;&#x9;&#x9;r  = sheet.getRow(i);&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;c = r.getCell(0);&#xD;&#xA;&#x9;&#x9;&#x9;x = c.getStringCellValue();&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;c = r.getCell(1);&#xD;&#xA;&#x9;&#x9;&#x9;y = c.getStringCellValue();&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;c = r.getCell(2);&#xD;&#xA;&#x9;&#x9;&#x9;name = c.getStringCellValue();&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;posFilter.add( createCoordinate(Integer.parseInt(x), Integer.parseInt(y)));&#xD;&#xA;&#x9;&#x9;&#x9;listFilter.add(name);&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;r = sheet.getRow(sheet.getLastRowNum());&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;c = r.getCell(0);&#xD;&#xA;&#x9;&#x9;x = c.getStringCellValue();&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;c = r.getCell(1);&#xD;&#xA;&#x9;&#x9;y = c.getStringCellValue();&#xD;&#xA;&#x9;&#x9;posFilter.add( createCoordinate(Integer.parseInt(x), Integer.parseInt(y)));&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eOperations name="createCoordinate" eType="#//domain/util/Coordinate">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;pgr.domain.util.impl.CoordinateImpl c = (pgr.domain.util.impl.CoordinateImpl)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; pgr.domain.util.UtilFactory.eINSTANCE.createCoordinate();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9; c.setX(x); c.setY(y);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;return c;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="x" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
          <eParameters name="y" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
        </eOperations>
        <eOperations name="refresh">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;readSheetQuery();&#xD;&#xA;&#x9;&#x9;executeQuery();&#xD;&#xA;&#x9;"/>
          </eAnnotations>
        </eOperations>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="filePath" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="stringQuery" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="workbook" eType="#//datatypes/datatypeapachepoi/XSSFWorkbook"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="dc" eType="#//datatypes/datatypesqm/DataConnection"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="posFilter" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="listFilter" eType="#//datatypes/datatypesjavautil/ArrayList"/>
        <eStructuralFeatures xsi:type="ecore:EReference" name="Domain" eType="#//domain/Domain"
            transient="true" eOpposite="#//domain/Domain/theExcelUpdater"/>
      </eClassifiers>
    </eSubpackages>
    <eSubpackages name="util" nsURI="http:///pgr/domain/util.ecore" nsPrefix="pgr.domain.util">
      <eClassifiers xsi:type="ecore:EClass" name="Coordinate" instanceTypeName="Comparable">
        <eOperations name="compareTo" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#x9;CoordinateImpl c = (CoordinateImpl) c1;&#xD;&#xA;&#x9;if(x > c.x){&#xD;&#xA;&#x9;&#x9;return 1;&#xD;&#xA;&#x9;}&#xD;&#xA;&#x9;else if (x == c.x){&#xD;&#xA;&#x9;&#x9;if(y > c.y)&#xD;&#xA;&#x9;&#x9;&#x9;return 1;&#xD;&#xA;&#x9;&#x9;else if(y == c.y)&#xD;&#xA;&#x9;&#x9;&#x9;return 0;&#xD;&#xA;&#x9;}&#xD;&#xA;&#x9;return -1;"/>
          </eAnnotations>
          <eParameters name="c1" eType="#//datatypes/datatypesjava/Object"/>
        </eOperations>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="x" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EIntegerObject"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="y" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EIntegerObject"/>
        <eStructuralFeatures xsi:type="ecore:EReference" name="theDomain" eType="#//domain/Domain"
            transient="true" eOpposite="#//domain/Domain/theCoordinate"/>
      </eClassifiers>
      <eClassifiers xsi:type="ecore:EClass" name="MergedRegion">
        <eOperations name="MergedRegion">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#x9;&#x9;this.text = text;&#xD;&#xA;&#x9;&#x9;this.firstColumn = firstColumn;&#xD;&#xA;&#x9;&#x9;this.lastColumn = lastColumn;&#xD;&#xA;&#x9;&#x9;this.firstRow = firstRow;&#xD;&#xA;&#x9;&#x9;this.lastRow = lastRow;"/>
          </eAnnotations>
          <eParameters name="text" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
          <eParameters name="firstColumn" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EIntegerObject"/>
          <eParameters name="lastColumn" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EIntegerObject"/>
          <eParameters name="firstRow" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EIntegerObject"/>
          <eParameters name="lastRow" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EIntegerObject"/>
        </eOperations>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="text" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="firstColumn" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EIntegerObject"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="lastColumn" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EIntegerObject"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="firstRow" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EIntegerObject"/>
        <eStructuralFeatures xsi:type="ecore:EAttribute" name="lastRow" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EIntegerObject"/>
        <eStructuralFeatures xsi:type="ecore:EReference" name="theDomain" eType="#//domain/Domain"
            transient="true" eOpposite="#//domain/Domain/theMergedRegion"/>
      </eClassifiers>
      <eClassifiers xsi:type="ecore:EClass" name="ComparatorRange" instanceClassName="java.util.Comparator">
        <eOperations name="compare" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;org.apache.poi.ss.util.CellRangeAddress o1 = (org.apache.poi.ss.util.CellRangeAddress) arg0;&#xD;&#xA;&#x9;&#x9;org.apache.poi.ss.util.CellRangeAddress o2 = (org.apache.poi.ss.util.CellRangeAddress) arg1;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if(o1.getFirstRow() > o2.getFirstRow()){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;return 1;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;else if ( o1.getFirstRow() == o2.getFirstRow()){&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if( o1.getFirstColumn() > o2.getFirstColumn())&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;return 1;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;else if(o1.getFirstColumn() == o2.getFirstColumn())&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;return 0;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;return -1;&#xD;&#xA;&#x9;"/>
          </eAnnotations>
          <eParameters name="arg0" eType="#//datatypes/datatypesjava/Object"/>
          <eParameters name="arg1" eType="#//datatypes/datatypesjava/Object"/>
        </eOperations>
        <eStructuralFeatures xsi:type="ecore:EReference" name="theDomain" eType="#//domain/Domain"
            transient="true" eOpposite="#//domain/Domain/theComparatorRange"/>
      </eClassifiers>
      <eClassifiers xsi:type="ecore:EClass" name="Unzip">
        <eOperations name="copyInputStream">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#x9;&#x9;byte[] buffer = new byte[1024];&#xD;&#xA;&#x9;&#x9;int len;&#xD;&#xA;&#x9;&#x9;try {&#xD;&#xA;&#x9;&#x9;&#x9;while ((len = in.read(buffer)) >= 0)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;out.write(buffer, 0, len);&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;in.close();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;out.close();&#xD;&#xA;&#x9;&#x9;} catch (java.io.IOException e) {&#xD;&#xA;&#x9;&#x9;&#x9;// TODO Auto-generated catch block&#xD;&#xA;&#x9;&#x9;&#x9;e.printStackTrace();&#xD;&#xA;&#x9;&#x9;}"/>
          </eAnnotations>
          <eParameters name="in" eType="#//datatypes/datatypesjava/InputStream"/>
          <eParameters name="out" eType="#//datatypes/datatypesjava/OutputStream"/>
        </eOperations>
        <eOperations name="removeExtension" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#x9;&#x9;int index = fileName.length()-1;&#xD;&#xA;&#x9;&#x9;char c = fileName.charAt(index);&#xD;&#xA;&#x9;&#x9;while(c!='.'){&#xD;&#xA;&#x9;&#x9;&#x9;index--;&#xD;&#xA;&#x9;&#x9;&#x9;c = fileName.charAt(index);&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;return fileName.substring(0, index);"/>
          </eAnnotations>
          <eParameters name="fileName" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        </eOperations>
        <eOperations name="unzip">
          <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
            <details key="body" value="&#x9;&#x9;java.util.Enumeration&lt;?> entries;&#xD;&#xA;&#x9;&#x9;java.util.zip.ZipFile zipFile;&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;String dir = &quot;OpenXML/&quot; + removeExtension(fileName)+&quot;/&quot;;&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;&#x9;try {&#xD;&#xA;&#x9;&#x9;&#x9;zipFile = new java.util.zip.ZipFile(url);&#xD;&#xA;&#x9;&#x9;&#x9;entries = zipFile.entries();&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;while (entries.hasMoreElements()) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;java.util.zip.ZipEntry entry = (java.util.zip.ZipEntry) entries.nextElement();&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (entry.isDirectory()) {&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;// Assume directories are stored parents first then&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;// children.&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;java.io.File parent = new java.io.File(entry.getName()).getParentFile();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if (parent != null)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;{&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;    parent.mkdirs();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;//System.err.println(&quot;Extracting directory: &quot;+ entry.getName());&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;(new java.io.File(entry.getName())).mkdirs();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;continue;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;java.io.File parent = new java.io.File(dir+entry.getName()).getParentFile();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;if (parent != null)&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;{&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;    parent.mkdirs();&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;//System.err.println(&quot;Extracting file: &quot; + entry.getName());&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;copyInputStream( zipFile.getInputStream(entry), &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;new java.io.BufferedOutputStream(new java.io.FileOutputStream(dir+entry.getName())));&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;zipFile.close();&#xD;&#xA;&#x9;&#x9;} catch (java.io.IOException ioe) {&#xD;&#xA;&#x9;&#x9;&#x9;System.err.println(&quot;Unhandled exception:&quot;);&#xD;&#xA;&#x9;&#x9;&#x9;ioe.printStackTrace();&#xD;&#xA;&#x9;&#x9;&#x9;return;&#xD;&#xA;&#x9;&#x9;}"/>
          </eAnnotations>
          <eParameters name="url" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
          <eParameters name="fileName" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
        </eOperations>
        <eStructuralFeatures xsi:type="ecore:EReference" name="theDomain" eType="#//domain/Domain"
            transient="true" eOpposite="#//domain/Domain/theUnzip"/>
      </eClassifiers>
    </eSubpackages>
  </eSubpackages>
  <eSubpackages name="ui" nsURI="http:///pgr/ui.ecore" nsPrefix="pgr.ui">
    <eClassifiers xsi:type="ecore:EClass" name="UI">
      <eStructuralFeatures xsi:type="ecore:EReference" name="theDomain" upperBound="-1"
          eType="#//domain/Domain" eOpposite="#//domain/Domain/theUI"/>
      <eStructuralFeatures xsi:type="ecore:EReference" name="theModelFactory" eType="#//ModelFactory"
          transient="true" eOpposite="#//ModelFactory/theUI"/>
      <eStructuralFeatures xsi:type="ecore:EReference" name="theReportView" lowerBound="1"
          eType="#//ui/ReportView" containment="true" eOpposite="#//ui/ReportView/ownedByUI"/>
    </eClassifiers>
    <eClassifiers xsi:type="ecore:EClass" name="ReportView">
      <eStructuralFeatures xsi:type="ecore:EReference" name="ownedByUI" eType="#//ui/UI"
          transient="true" eOpposite="#//ui/UI/theReportView"/>
      <eStructuralFeatures xsi:type="ecore:EReference" name="listReportViewModel"
          upperBound="-1" eType="#//ui/ReportViewModel" containment="true" eOpposite="#//ui/ReportViewModel/ownedByReportView"/>
    </eClassifiers>
    <eClassifiers xsi:type="ecore:EClass" name="ReportViewModel">
      <eStructuralFeatures xsi:type="ecore:EAttribute" name="name" eType="ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString"/>
      <eStructuralFeatures xsi:type="ecore:EReference" name="ownedByReportView" eType="#//ui/ReportView"
          transient="true" eOpposite="#//ui/ReportView/listReportViewModel"/>
    </eClassifiers>
  </eSubpackages>
  <eSubpackages name="datatypes" nsURI="http:///pgr/datatypes.ecore" nsPrefix="pgr.datatypes">
    <eClassifiers xsi:type="ecore:EDataType" name="Document" instanceClassName="org.w3c.dom.Document"/>
    <eClassifiers xsi:type="ecore:EDataType" name="ResultSet" instanceClassName="java.sql.ResultSet"/>
    <eClassifiers xsi:type="ecore:EDataType" name="EList" instanceClassName="org.eclipse.emf.common.util.EList"/>
    <eSubpackages name="datatypesqm" nsURI="http:///pgr/datatypes/datatypesqm.ecore"
        nsPrefix="pgr.datatypes.datatypesqm">
      <eClassifiers xsi:type="ecore:EDataType" name="ModelFactory" instanceClassName="gestionmodelosconsultas.ModelFactory"/>
      <eClassifiers xsi:type="ecore:EDataType" name="ElementoConsulta" instanceClassName="gestionmodelosconsultas.modeloconsultas.model.ElementoConsulta"/>
      <eClassifiers xsi:type="ecore:EDataType" name="ResultElement" instanceClassName="gestionmodelosconsultas.modeloconsultas.resultset.ResultElement"/>
      <eClassifiers xsi:type="ecore:EDataType" name="ElementoModeloResultado" instanceClassName="gestionmodelosconsultas.modeloconsultas.resultset.ElementoModeloResultado"/>
      <eClassifiers xsi:type="ecore:EDataType" name="Resultado" instanceClassName="gestionmodelosconsultas.modeloconsultas.resultset.Resultado"/>
      <eClassifiers xsi:type="ecore:EDataType" name="TableView" instanceClassName="tooldataform.formmodel.concreta.TableView"/>
      <eClassifiers xsi:type="ecore:EDataType" name="DataConnection" instanceClassName="gestionconsultassqlmodels.generate.conexionBD.DataConnection"/>
      <eClassifiers xsi:type="ecore:EDataType" name="WhoownmemodelModelFactoryModel"
          instanceClassName="whoownme.model.ModelFactoryModel"/>
      <eClassifiers xsi:type="ecore:EDataType" name="Proyeccion" instanceClassName="gestionmodelosconsultas.modeloconsultas.model.Proyeccion"/>
      <eClassifiers xsi:type="ecore:EDataType" name="EADiagram" instanceClassName="gestionmodelosconsultas.modeloconsultas.model.EADiagram"/>
    </eSubpackages>
    <eSubpackages name="datatypesdataform" nsURI="http:///pgr/datatypes/datatypesdataform.ecore"
        nsPrefix="pgr.datatypes.datatypesdataform">
      <eClassifiers xsi:type="ecore:EDataType" name="ModelFactory" instanceClassName="tooldataform.ModelFactory"/>
      <eClassifiers xsi:type="ecore:EDataType" name="DataForm_Diagram" instanceClassName="tooldataform.formmodel.concreta.DataForm_Diagram"/>
      <eClassifiers xsi:type="ecore:EDataType" name="Domain_Diagram" instanceClassName="tooldataform.core.Domain_Diagram"/>
      <eClassifiers xsi:type="ecore:EDataType" name="Containment" instanceClassName="tooldataform.formmodel.concreta.Containment"/>
      <eClassifiers xsi:type="ecore:EDataType" name="Container" instanceClassName="tooldataform.formmodel.concreta.Container"/>
      <eClassifiers xsi:type="ecore:EDataType" name="Interface" instanceClassName="tooldataform.formmodel.concreta.Interface"/>
      <eClassifiers xsi:type="ecore:EDataType" name="GraphicalContainer" instanceClassName="tooldataform.formmodel.containers.GraphicalContainer"/>
      <eClassifiers xsi:type="ecore:EDataType" name="Clase" instanceClassName="tooldataform.pmoo.Clase"/>
      <eClassifiers xsi:type="ecore:EDataType" name="Project" instanceClassName="tooldataform.core.Project"/>
    </eSubpackages>
    <eSubpackages name="datatypesgmf" nsURI="http:///pgr/datatypes/datatypesgmf.ecore"
        nsPrefix="pgr.datatypes.datatypesgmf">
      <eClassifiers xsi:type="ecore:EDataType" name="Bounds" instanceClassName="org.eclipse.gmf.runtime.notation.Bounds"/>
      <eClassifiers xsi:type="ecore:EDataType" name="Diagram" instanceClassName="org.eclipse.gmf.runtime.notation.Diagram"/>
      <eClassifiers xsi:type="ecore:EDataType" name="Node" instanceClassName="org.eclipse.gmf.runtime.notation.Node"/>
    </eSubpackages>
    <eSubpackages name="datatypesjavautil" nsURI="http:///pgr/datatypes/datatypesjavautil.ecore"
        nsPrefix="pgr.datatypes.datatypesjavautil">
      <eClassifiers xsi:type="ecore:EDataType" name="ArrayList" instanceClassName="java.util.ArrayList"/>
      <eClassifiers xsi:type="ecore:EDataType" name="List" instanceClassName="java.util.List"/>
      <eClassifiers xsi:type="ecore:EDataType" name="HashMapStringElementoConsulta"
          instanceClassName="java.util.HashMap"/>
      <eClassifiers xsi:type="ecore:EDataType" name="MapStringInteger" instanceClassName="java.util.Map"/>
      <eClassifiers xsi:type="ecore:EDataType" name="Set" instanceClassName="java.util.Set"/>
    </eSubpackages>
    <eSubpackages name="datatypeapachepoi" nsURI="http:///pgr/datatypes/datatypeapachepoi.ecore"
        nsPrefix="pgr.datatypes.datatypeapachepoi">
      <eClassifiers xsi:type="ecore:EDataType" name="XSSFWorkbook" instanceClassName="org.apache.poi.xssf.usermodel.XSSFWorkbook"/>
      <eClassifiers xsi:type="ecore:EDataType" name="XSSFSheet" instanceClassName="org.apache.poi.xssf.usermodel.XSSFSheet"/>
      <eClassifiers xsi:type="ecore:EDataType" name="XSSFCell" instanceClassName="org.apache.poi.xssf.usermodel.XSSFCell"/>
    </eSubpackages>
    <eSubpackages name="datatypesjava" nsURI="http:///pgr/datatypes/datatypesjava.ecore"
        nsPrefix="pgr.datatypes.datatypesjava">
      <eClassifiers xsi:type="ecore:EDataType" name="Object" instanceClassName="java.lang.Object"/>
      <eClassifiers xsi:type="ecore:EDataType" name="InputStream" instanceClassName="java.io.InputStream"/>
      <eClassifiers xsi:type="ecore:EDataType" name="OutputStream" instanceClassName="java.io.OutputStream"/>
    </eSubpackages>
  </eSubpackages>
</ecore:EPackage>
